<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: FlexMix Interface for Adaptive Lasso / Elastic Net with GLMs</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for FLXMRglmnet {flexmix}"><tr><td>FLXMRglmnet {flexmix}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>FlexMix Interface for Adaptive Lasso / Elastic Net with GLMs</h2>

<h3>Description</h3>

<p>This is a driver which allows fitting of mixtures of GLMs where
the coefficients are penalized using the (adaptive) lasso or the
elastic net by reusing functionality from package <span class="pkg">glmnet</span>.
</p>


<h3>Usage</h3>

<pre>
    FLXMRglmnet(formula = . ~ ., family = c("gaussian", "binomial", "poisson"),
              adaptive = TRUE, select = TRUE, offset = NULL, ...)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>formula</code></td>
<td>
<p>A formula which is interpreted relative to the formula
specified in the call to <code><a href="flexmix.html">flexmix</a></code> using
<code><a href="../../stats/html/update.formula.html">update.formula</a></code>. Default is to use the original
<code><a href="flexmix.html">flexmix</a></code> model
formula.</p>
</td></tr>
<tr valign="top"><td><code>family</code></td>
<td>
<p>A character string naming a <code><a href="../../stats/html/glm.html">glm</a></code>
family function.</p>
</td></tr>
<tr valign="top"><td><code>adaptive</code></td>
<td>
<p>A logical indicating if the adaptive lasso should be
used. By default equal to <code>TRUE</code>.</p>
</td></tr>
<tr valign="top"><td><code>select</code></td>
<td>
<p>A logical vector indicating which variables in the
model matrix should be included in the penalized part.  By default
equal to <code>TRUE</code> implying that all variables are penalized.</p>
</td></tr>
<tr valign="top"><td><code>offset</code></td>
<td>
<p>This can be used to specify an <em>a priori</em> known
component to be included in the linear predictor during fitting.</p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
<p>Additional arguments to be passed to
<code><a href="../../glmnet/html/cv.glmnet.html">cv.glmnet</a></code> fitter.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Some care is needed to ensure convergence of the algorithm, which is
computationally more challenging than a standard EM.  In the proposed
method, not only are cluster allocations identified and component
parameters estimated as commonly done in mixture models, but there is
also variable selection via penalized regression using $k$-fold
cross-validation to choose the penalty parameter.  For the algorithm
to converge, it is necessary that the same cross-validation
partitioning be used across the EM iterations, i.e., the subsamples
for cross-validation must be defined at the beginning This is
accomplished using the <code>foldid</code> option as an additional parameter
to be passed to <code><a href="../../glmnet/html/cv.glmnet.html">cv.glmnet</a></code> (see
<span class="pkg">glmnet</span> package documentation).
</p>


<h3>Value</h3>

<p>Returns an object of class <code>FLXMRglm</code>.
</p>


<h3>Author(s)</h3>

<p>Frederic Mortier and Nicolas Picard.
</p>


<h3>References</h3>

<p>Frederic Mortier, Dakis-Yaoba Ouedraogo, Florian Claeys, Mahlet
G. Tadesse, Guillaume Cornu, Fidele Baya, Fabrice Benedet, Vincent
Freycon, Sylvie Gourlet-Fleury and Nicolas Picard.
Mixture of inhomogeneous matrix models for species-rich ecosystems.
<em>Environmetrics</em>, in press.<br />
doi:10.1002/env.2320
</p>


<h3>See Also</h3>

<p><code><a href="FLXglm.html">FLXMRglm</a></code>
</p>


<h3>Examples</h3>

<pre>
    set.seed(12)
    p &lt;- 10
    beta &lt;- matrix(0, nrow = p + 1, ncol = 2)
    beta[1,] &lt;- c(-1, 1)
    beta[cbind(c(5, 10), c(1, 2))] &lt;- 1

    nobs &lt;- 100
    X &lt;- matrix(rnorm(nobs * p), nobs, p)
    mu &lt;- cbind(1, X) %*% beta
    z &lt;- sample(1:ncol(beta), nobs, replace = TRUE)
    y &lt;- mu[cbind(1:nobs, z)] + rnorm(nobs)
    data &lt;- data.frame(y, X)
    ## The maximum number of iterations is reduced to
    ## avoid a long running time.
    fo &lt;- sample(rep(seq(10), length = nrow(data)))
    ex1 &lt;- flexmix(y ~ ., data = data, k = 2, cluster = z,
                   model = FLXMRglmnet(foldid = fo),
                   control = list(iter.max = 2))
    parameters(ex1)
</pre>

<hr /><div style="text-align: center;">[Package <em>flexmix</em> version 2.3-14 <a href="00Index.html">Index</a>]</div>
</body></html>
