<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Run FlexMix Repeatedly</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for stepFlexmix {flexmix}"><tr><td>stepFlexmix {flexmix}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Run FlexMix Repeatedly</h2>

<h3>Description</h3>

<p>Runs flexmix repeatedly for different numbers of components and returns
the maximum likelihood solution for each.
</p>


<h3>Usage</h3>

<pre>
initFlexmix(..., k, init = list(), control = list(), nrep = 3L,
            verbose = TRUE, drop = TRUE, unique = FALSE)
initMethod(name = c("tol.em", "cem.em", "sem.em"),
           step1 = list(tolerance = 10^-2),
           step2 = list(), control = list(), nrep = 3L)

stepFlexmix(..., k = NULL, nrep = 3, verbose = TRUE, drop = TRUE,
            unique = FALSE)

## S4 method for signature 'stepFlexmix,missing'
plot(x, y, what = c("AIC", "BIC", "ICL"),
  xlab = NULL, ylab = NULL, legend = "topright", ...)

## S4 method for signature 'stepFlexmix'
getModel(object, which = "BIC")

## S4 method for signature 'stepFlexmix'
unique(x, incomparables = FALSE, ...)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>...</code></td>
<td>
<p>Passed to <code><a href="flexmix.html">flexmix</a></code> (or <code><a href="../../graphics/html/matplot.html">matplot</a></code>
in the <code>plot</code> method).</p>
</td></tr>
<tr valign="top"><td><code>k</code></td>
<td>
<p>A vector of integers passed in turn to the <code>k</code> argument
of <code><a href="flexmix.html">flexmix</a></code>.</p>
</td></tr>
<tr valign="top"><td><code>init</code></td>
<td>
<p>An object of class <code>"initMethod"</code> or a named list
where <code>initMethod</code> is called with it as arguments in addition
to the <code>control</code> argument.</p>
</td></tr>
<tr valign="top"><td><code>name</code></td>
<td>
<p>A character string indication which initialization
strategy should be employed: short runs of EM followed by a long
(<code>"tol.em"</code>), short runs of CEM followed by a long EM run
(<code>"cem.em"</code>), short runs of SEM followed by a long EM run
(<code>"sem.em"</code>).</p>
</td></tr>
<tr valign="top"><td><code>step1</code></td>
<td>
<p>A named list which combined with the <code>control</code>
argument is coercable to a <code>"FLXcontrol"</code> object. This control
setting is used for the short runs.</p>
</td></tr>
<tr valign="top"><td><code>step2</code></td>
<td>
<p>A named list which combined with the <code>control</code>
argument is coercable to a <code>"FLXcontrol"</code> object. This control
setting is used for the long run.</p>
</td></tr>
<tr valign="top"><td><code>control</code></td>
<td>
<p>A named list which combined with the <code>step1</code> or
the <code>step2</code> argument is coercable to a <code>"FLXcontrol"</code>
object.</p>
</td></tr>  
<tr valign="top"><td><code>nrep</code></td>
<td>
<p>For each value of <code>k</code> run <code><a href="flexmix.html">flexmix</a></code>
<code>nrep</code> times and keep only the solution with maximum
likelihood. If <code>nrep</code> is set for the long run, it is ignored,
because the EM algorithm is deterministic using the best solution
discovered in the short runs for initialization.</p>
</td></tr>
<tr valign="top"><td><code>verbose</code></td>
<td>
<p>If <code>TRUE</code>, show progress information during
computations.</p>
</td></tr>
<tr valign="top"><td><code>drop</code></td>
<td>
<p>If <code>TRUE</code> and <code>k</code> is of length 1, then a single
flexmix object is returned instead of a <code>"stepFlexmix"</code>
object.</p>
</td></tr>
<tr valign="top"><td><code>unique</code></td>
<td>
<p>If <code>TRUE</code>, then <code>unique()</code> is called on the
result, see below.</p>
</td></tr>
<tr valign="top"><td><code>x, object</code></td>
<td>
<p>An object of class <code>"stepFlexmix"</code>.</p>
</td></tr>
<tr valign="top"><td><code>y</code></td>
<td>
<p>Not used.</p>
</td></tr>
<tr valign="top"><td><code>what</code></td>
<td>
<p>Character vector naming information criteria to
plot. Functions of the same name must exist, which take a
<code>stepFlexmix</code> object as input and return a numeric vector like
<code>AIC,stepFlexmix-method</code> (see examples below).</p>
</td></tr>
<tr valign="top"><td><code>xlab,ylab</code></td>
<td>
<p>Graphical parameters.</p>
</td></tr>
<tr valign="top"><td><code>legend</code></td>
<td>
<p>If not <code>FALSE</code> and <code>what</code> contains more
than 1 element, a legend is placed at the specified location, see
<code><a href="../../graphics/html/legend.html">legend</a></code> for details.</p>
</td></tr>
<tr valign="top"><td><code>which</code></td>
<td>
<p>Number of model to get. If character, interpreted as
number of components or name of an information criterion.</p>
</td></tr>
<tr valign="top"><td><code>incomparables</code></td>
<td>
<p>A vector of values that cannot be
compared. Currently, <code>FALSE</code> is the only possible value,
meaning that all values can be compared.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>"stepFlexmix"</code> containing the best models
with respect to the log likelihood for the different number of
components in a slot if <code>length(k)&gt;1</code>, else directly an object of
class <code>"flexmix"</code>.
</p>
<p>If <code>unique = FALSE</code>, then the resulting object contains one
model per element of <code>k</code> (which is the number of clusters the EM
algorithm started with). If <code>unique = TRUE</code>, then the result
is resorted according to the number of clusters contained in the
fitted models (which may be less than the number with which the EM
algorithm started), and only the maximum likelihood solution for each
number of fitted clusters is kept. This operation can also be done
manually by calling <code>unique()</code> on objects of class
<code>"stepFlexmix"</code>. 
</p>


<h3>Author(s)</h3>

<p>Friedrich Leisch and Bettina Gruen</p>


<h3>References</h3>

<p>Friedrich Leisch. FlexMix: A general framework for finite mixture
models and latent class regression in R. <em>Journal of Statistical
Software</em>, <b>11</b>(8), 2004. doi:10.18637/jss.v011.i08
</p>
<p>Christophe Biernacki, Gilles Celeux and Gerard Govaert. Choosing
starting values for the EM algorithm for getting the highest
likelihood in multivariate Gaussian mixture models. <em>Computational
Statistics &amp; Data Analysis</em>, <b>41</b>(3&ndash;4), 561&ndash;575, 2003.
</p>
<p>Theresa Scharl, Bettina Gruen and Friedrch Leisch.  Mixtures of
regression models for time-course gene expression data: Evaluation of
initialization and random effects. <em>Bioinformatics</em>,
<b>26</b>(3), 370&ndash;377, 2010.
</p>


<h3>Examples</h3>

<pre>
data("Nclus", package = "flexmix")

## try 2 times for k = 4
set.seed(511)
ex1 &lt;- initFlexmix(Nclus~1, k = 4, model = FLXMCmvnorm(diagonal = FALSE),
                   nrep = 2)
ex1

## now 2 times each for k = 2:5, specify control parameter
ex2 &lt;- initFlexmix(Nclus~1, k = 2:5, model = FLXMCmvnorm(diagonal = FALSE),
                   control = list(minprior = 0), nrep = 2)
ex2
plot(ex2)

## get BIC values
BIC(ex2)

## get smallest model
getModel(ex2, which = 1)

## get model with 3 components
getModel(ex2, which = "3")

## get model with smallest ICL (here same as for AIC and BIC: true k = 4)
getModel(ex2, which = "ICL")

## now 1 time each for k = 2:5, with larger minimum prior
ex3 &lt;- initFlexmix(Nclus~1, k = 2:5,
                   model = FLXMCmvnorm(diagonal = FALSE),
                   control = list(minprior = 0.1), nrep = 1)
ex3

## keep only maximum likelihood solution for each unique number of
## fitted clusters:
unique(ex3)
</pre>

<hr /><div style="text-align: center;">[Package <em>flexmix</em> version 2.3-14 <a href="00Index.html">Index</a>]</div>
</body></html>
