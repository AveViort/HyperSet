<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Flexible Mixture Modeling</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for flexmix {flexmix}"><tr><td>flexmix {flexmix}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Flexible Mixture Modeling</h2>

<h3>Description</h3>

<p>FlexMix implements a general framework for finite
mixtures of regression models. Parameter estimation is performed using
the EM algorithm: the E-step is implemented by <code>flexmix</code>, while
the user can specify the M-step.
</p>


<h3>Usage</h3>

<pre>
flexmix(formula, data = list(), k = NULL, cluster = NULL, 
        model = NULL, concomitant = NULL, control = NULL,
        weights = NULL)
## S4 method for signature 'flexmix'
summary(object, eps = 1e-4, ...)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>formula</code></td>
<td>
<p>A symbolic description of the model to be fit. The
general form is <code>y~x|g</code> where <code>y</code> is the response,
<code>x</code> the set of predictors and <code>g</code> an optional grouping
factor for repeated measurements.</p>
</td></tr>
<tr valign="top"><td><code>data</code></td>
<td>
<p>An optional data frame containing the variables in the model.</p>
</td></tr>
<tr valign="top"><td><code>k</code></td>
<td>
<p>Number of clusters (not needed if <code>cluster</code> is specified).</p>
</td></tr>
<tr valign="top"><td><code>cluster</code></td>
<td>
<p>Either a matrix with <code>k</code> columns of initial
cluster membership probabilities for each observation; or a factor
or integer vector with the initial cluster
assignments of observations at the start of the EM
algorithm. Default is random assignment into <code>k</code>
clusters.</p>
</td></tr>
<tr valign="top"><td><code>weights</code></td>
<td>
<p>An optional vector of replication weights to be used in
the fitting process.  Should be <code>NULL</code>, an integer vector or a
formula.</p>
</td></tr>
<tr valign="top"><td><code>model</code></td>
<td>
<p>Object of class <code>FLXM</code> or list of <code>FLXM</code>
objects. Default is the object returned by calling
<code><a href="FLXglm.html">FLXMRglm</a>()</code>.</p>
</td></tr>
<tr valign="top"><td><code>concomitant</code></td>
<td>
<p>Object of class <code>FLXP</code>. Default is the
object returned by calling <code><a href="FLXconcomitant.html">FLXPconstant</a></code>.</p>
</td></tr>
<tr valign="top"><td><code>control</code></td>
<td>
<p>Object of class <code>FLXcontrol</code> or a named list.</p>
</td></tr>
<tr valign="top"><td><code>object</code></td>
<td>
<p>Object of class <code>flexmix</code>.</p>
</td></tr>
<tr valign="top"><td><code>eps</code></td>
<td>
<p>Probabilities below this threshold are treated as zero in the
summary method.</p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
<p>Currently not used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>FlexMix models are described by objects of class <code>FLXM</code>,
which in turn are created by driver functions like
<code><a href="FLXglm.html">FLXMRglm</a></code> or <code><a href="FLXmclust.html">FLXMCmvnorm</a></code>. Multivariate
responses with independent components can be specified using a
list of <code>FLXM</code> objects.
</p>
<p>The <code>summary</code> method lists for each component the prior
probability, the number of observations assigned to the corresponding
cluster, the number of observations with a posterior probability
larger than <code>eps</code> and the ratio of the latter two numbers (which
indicates how separated the cluster is from the others).
</p>


<h3>Value</h3>

<p>Returns an object of class <code>flexmix</code>.
</p>


<h3>Author(s)</h3>

<p>Friedrich Leisch and Bettina Gruen</p>


<h3>References</h3>

<p>Friedrich Leisch. FlexMix: A general framework for finite mixture
models and latent class regression in R. <em>Journal of Statistical
Software</em>, <b>11</b>(8), 2004. doi:10.18637/jss.v011.i08
</p>
<p>Bettina Gruen and Friedrich Leisch. Fitting finite mixtures of
generalized linear regressions in R. Computational Statistics &amp; Data
Analysis, 51(11), 5247-5252, 2007. doi:10.1016/j.csda.2006.08.014
</p>
<p>Bettina Gruen and Friedrich Leisch. FlexMix Version 2: Finite
mixtures with concomitant variables and varying and constant
parameters Journal of Statistical Software, 28(4), 1-35, 2008.
doi:10.18637/jss.v028.i04
</p>


<h3>See Also</h3>

<p><code><a href="plot-methods.html">plot-methods</a></code></p>


<h3>Examples</h3>

<pre>

data("NPreg", package = "flexmix")

## mixture of two linear regression models. Note that control parameters
## can be specified as named list and abbreviated if unique.
ex1 &lt;- flexmix(yn ~ x + I(x^2), data = NPreg, k = 2,
               control = list(verb = 5, iter = 100))

ex1
summary(ex1)
plot(ex1)

## now we fit a model with one Gaussian response and one Poisson
## response. Note that the formulas inside the call to FLXMRglm are
## relative to the overall model formula.
ex2 &lt;- flexmix(yn ~ x, data = NPreg, k = 2,
               model = list(FLXMRglm(yn ~ . + I(x^2)), 
                            FLXMRglm(yp ~ ., family = "poisson")))
plot(ex2)

ex2
table(ex2@cluster, NPreg$class)

## for Gaussian responses we get coefficients and standard deviation
parameters(ex2, component = 1, model = 1)

## for Poisson response we get only coefficients
parameters(ex2, component = 1, model = 2)

## fitting a model only to the Poisson response is of course
## done like this
ex3 &lt;- flexmix(yp ~ x, data = NPreg, k = 2,
               model = FLXMRglm(family = "poisson"))

## if observations are grouped, i.e., we have several observations per
## individual, fitting is usually much faster:
ex4 &lt;- flexmix(yp~x|id1, data = NPreg, k = 2,
               model = FLXMRglm(family = "poisson"))

## And now a binomial example. Mixtures of binomials are not generically
## identified, here the grouping variable is necessary:
set.seed(1234)
ex5 &lt;- initFlexmix(cbind(yb,1 - yb) ~ x, data = NPreg, k = 2,
                   model = FLXMRglm(family = "binomial"), nrep = 5)
table(NPreg$class, clusters(ex5))

ex6 &lt;- initFlexmix(cbind(yb, 1 - yb) ~ x | id2, data = NPreg, k = 2,
                   model = FLXMRglm(family = "binomial"), nrep = 5)
table(NPreg$class, clusters(ex6))

</pre>

<hr /><div style="text-align: center;">[Package <em>flexmix</em> version 2.3-14 <a href="00Index.html">Index</a>]</div>
</body></html>
