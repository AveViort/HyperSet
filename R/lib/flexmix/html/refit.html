<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Refit a Fitted Model</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for refit-methods {flexmix}"><tr><td>refit-methods {flexmix}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Refit a Fitted Model</h2>

<h3>Description</h3>

<p>Refits an estimated flexmix model to obtain additional information
like coefficient significance p-values for GLM regression.
</p>


<h3>Usage</h3>

<pre>
## S4 method for signature 'flexmix'
refit(object, newdata, method = c("optim",
"mstep"), ...)
## S4 method for signature 'FLXRoptim'
summary(object, model = 1, which = c("model",
"concomitant"), ...)
## S4 method for signature 'FLXRmstep'
summary(object, model = 1, which = c("model",
"concomitant"), ...)

## S4 method for signature 'FLXRoptim,missing'
plot(x, y, model = 1, which = c("model", "concomitant"),
         bycluster = TRUE, alpha = 0.05, components, labels = NULL,
         significance = FALSE, xlab = NULL, ylab = NULL, ci = TRUE,
         scales = list(), as.table = TRUE, horizontal = TRUE, ...)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>object</code></td>
<td>
<p>An object of class <code>"flexmix"</code></p>
</td></tr>
<tr valign="top"><td><code>newdata</code></td>
<td>
<p>Optional new data.</p>
</td></tr>
<tr valign="top"><td><code>method</code></td>
<td>
<p>Specifies if the variance covariance matrix is
determined using <code><a href="../../stats/html/optim.html">optim</a></code> or if the posteriors are
assumed as given and an M-step is performed.</p>
</td></tr>
<tr valign="top"><td><code>model</code></td>
<td>
<p>The model (for a multivariate response) that shall be
used.</p>
</td></tr>
<tr valign="top"><td><code>which</code></td>
<td>
<p>Specifies if a component specific model or the
concomitant variable model is used.</p>
</td></tr>
<tr valign="top"><td><code>x</code></td>
<td>
<p>An object of class <code>"FLXRoptim"</code></p>
</td></tr>
<tr valign="top"><td><code>y</code></td>
<td>
<p>Missing object.</p>
</td></tr>
<tr valign="top"><td><code>bycluster</code></td>
<td>
<p>A logical if the parameters should be group by
cluster or by variable.</p>
</td></tr>
<tr valign="top"><td><code>alpha</code></td>
<td>
<p>Numeric indicating the significance level.</p>
</td></tr>
<tr valign="top"><td><code>components</code></td>
<td>
<p>Numeric vector specifying which components are
plotted. The default is to plot all components.</p>
</td></tr>
<tr valign="top"><td><code>labels</code></td>
<td>
<p>Character vector specifying the variable names used.</p>
</td></tr>
<tr valign="top"><td><code>significance</code></td>
<td>
<p>A logical indicating if non-significant
coefficients are shaded in a lighter grey.</p>
</td></tr>
<tr valign="top"><td><code>xlab</code></td>
<td>
<p>String for the x-axis label.</p>
</td></tr>
<tr valign="top"><td><code>ylab</code></td>
<td>
<p>String for the y-axis label.</p>
</td></tr>
<tr valign="top"><td><code>ci</code></td>
<td>
<p>A logical indicating if significant and insignificant
parameter estimates are shaded differently.</p>
</td></tr>
<tr valign="top"><td><code>scales</code></td>
<td>
<p>See argument of the same name for
function <code><a href="../../lattice/html/xyplot.html">xyplot</a></code>.</p>
</td></tr>
<tr valign="top"><td><code>as.table</code></td>
<td>
<p>See arguments of the same name for
function <code><a href="../../lattice/html/xyplot.html">xyplot</a></code>.</p>
</td></tr>
<tr valign="top"><td><code>horizontal</code></td>
<td>
<p>See arguments of the same name for
function <code><a href="../../lattice/html/xyplot.html">xyplot</a></code>.</p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
<p>Currently not used</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>refit</code> method for <code>FLXMRglm</code> models in
combination with the <code>summary</code> method can be
used to obtain the usual tests for significance of coefficients. Note
that the tests are valid only if <code>flexmix</code> returned the maximum
likelihood estimator of the parameters.  If <code>refit</code> is used with
<code>method = "mstep"</code> for these component specific models the
returned object contains a <code>glm</code> object for each component where
the elements <code>model</code> which is the model frame and <code>data</code>
which contains the original dataset are missing.
</p>


<h3>Value</h3>

<p>An object inheriting form class <code>FLXR</code> is returned. For the
method using <code>optim</code> the object has class <code>FLXRoptim</code> and
for the M-step method it has class <code>FLXRmstep</code>. Both classes give
similar results for their <code>summary</code> methods. 
Objects of class <code>FLXRoptim</code> have their own <code>plot</code> method.
<code>Lapply</code> can be used to further analyse the refitted component
specific models of objects of class <code>FLXRmstep</code>.
</p>


<h3>Warning</h3>

<p>For <code>method = "mstep"</code> the standard deviations are determined
separately for each of the components using the a-posteriori
probabilities as weights without accounting for the fact that the
components have been simultaneously estimated. The derived standard
deviations are hence approximative and should only be used in an
exploratory way, as they are underestimating the uncertainty given
that the missing information of the component memberships are replaced
by the expected values.
</p>
<p>The <code>newdata</code> argument can only be specified when using
<code>method = "mstep"</code> for refitting <code>FLXMRglm</code> components. A
variant of <code>glm</code> for weighted ML estimation is used for fitting
the components and full <code>glm</code> objects are returned. Please note
that in this case the data and the model frame are stored for each
component which can significantly increase the object size.  </p>


<h3>Author(s)</h3>

<p>Friedrich Leisch and Bettina Gruen</p>


<h3>References</h3>

<p>Friedrich Leisch. FlexMix: A general framework for finite mixture
models and latent class regression in R. <em>Journal of Statistical
Software</em>, <b>11</b>(8), 2004. doi:10.18637/jss.v011.i08
</p>


<h3>Examples</h3>

<pre>

data("NPreg", package = "flexmix")
ex1 &lt;- flexmix(yn ~ x + I(x^2), data = NPreg, k = 2)
ex1r &lt;- refit(ex1)

## in one component all coefficients should be highly significant,
## in the other component only the linear term
summary(ex1r)
</pre>

<hr /><div style="text-align: center;">[Package <em>flexmix</em> version 2.3-14 <a href="00Index.html">Index</a>]</div>
</body></html>
