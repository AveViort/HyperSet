<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Plot Heat Map Reordered Using Seriation</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for hmap {seriation}"><tr><td>hmap {seriation}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Plot Heat Map Reordered Using Seriation</h2>

<h3>Description</h3>

<p>Provides heat maps reordered using several different seriation methods.
This includes dendrogram based reordering with optimal leaf order and matrix seriation based heat maps.
</p>


<h3>Usage</h3>

<pre>
hmap(x, distfun = dist, method = "OLO", control = NULL, zlim = NULL, ...)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>x</code></td>
<td>
<p>a matrix or a dissimilarity matrix of class dist. If a dissimilarity
matrix is used, then the <code>distfun</code> is ignored. </p>
</td></tr>
<tr valign="top"><td><code>distfun</code></td>
<td>
<p>function used to compute the distance (dissimilarity) between
both rows and columns (default: <code>dist</code>). </p>
</td></tr>
<tr valign="top"><td><code>method</code></td>
<td>
<p>a character strings indicating the used seriation algorithm 
(see <code>seriate.dist</code>). If the method results in a dendrogram then
<code>heatmap</code> in <span class="pkg">stats</span> is used to show the dendrograms, otherwise
reordered distance matrices are shown instead.</p>
</td></tr>
<tr valign="top"><td><code>control</code></td>
<td>
<p>a list of control options passed on to the seriation 
algorithm specified in <code>method</code>.</p>
</td></tr> 
<tr valign="top"><td><code>zlim</code></td>
<td>
<p>range of values to display (defaults to the range 
of <code>x</code>).</p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
<p>further arguments.</p>
</td></tr> 
</table>


<h3>Details</h3>

<p>For dendrogram based heat maps the 
arguments are passed on to <code>heatmap.2</code> in
<span class="pkg">gplots</span>. See for example <code>margins</code> and <code>col</code>.
The following arguments for <code>heatmap.2</code> cannot be used:
<code>Rowv, Colv, hclustfun, reorderfun</code>.
</p>
<p>For seriation-based heat maps further arguments include:
</p>

<dl>
<dt><code>gp</code></dt><dd><p>an object of class <code>gpar</code> containing graphical
parameters (see <code>gpar</code> in package <span class="pkg">grid</span>).</p>
</dd>
<dt><code>newpage</code></dt><dd><p>a logical indicating  whether to start 
plot on a new
page (see <code>gpar</code> in package <span class="pkg">grid</span>).</p>
</dd> 
<dt><code>prop</code></dt><dd><p>a logical indicating whether the height and width of
<code>x</code> should be plotted proportional to its dimensions.</p>
</dd>
<dt><code>showdist</code></dt><dd><p>Display seriated dissimilarity matrices?                      Values are <code>"none"</code>, <code>"both"</code>, 
<code>"rows"</code> or <code>"columns"</code>. </p>
</dd> 
<dt><code>key</code></dt><dd><p>logical; show a colorkey?.</p>
</dd> 
<dt>key.lab</dt><dd><p> string plotted next to the color key.</p>
</dd>
<dt><code>axes</code></dt><dd><p> one of <code>"auto"</code> (default; show axis 
labels if there are
less than 25 labels), <code>"x"</code>, <code>"y"</code>, 
<code>"both"</code> and <code>"none"</code>.</p>
</dd> 
<dt><code>margins</code></dt><dd><p> bottom and right-hand-side margins are 
calculated automatically or can be specifies as a vector 
of two numbers (in lines).</p>
</dd> 
<dt><code>zlim</code></dt><dd><p> range of values displayed.</p>
</dd> 
<dt><code>col</code>, <code>col_dist</code></dt><dd><p> color palettes used.</p>
</dd> 
</dl>
      
<p>For <code>dendrogram = TRUE</code>, <code>seriate.hclust</code> 
with the default method <code>"optimal"</code> is used for arranging the
dendrograms and <code>x</code>. <code>heatmap</code> is used for plotting.
</p>
<p>For <code>dendrogram = FALSE</code>, <code>seriate.dist</code> 
with the default method <code>"tsp"</code>
(a traveling salesperson solver) for arranging <code>x</code> is used.
<span class="pkg">grid</span> code implemented in this package 
is used to produce the plot.
</p>
<p>Note that unlike the default behavior of <code>heatmap</code>, 
scaling is not automatically applied. The data
have to be scaled before using <code>hmap</code>.
</p>


<h3>Value</h3>

<p>An invisible list with elements: 
</p>
<table summary="R valueblock">
<tr valign="top"><td><code>rowInd, colInd</code></td>
<td>
<p>index permutation vectors.</p>
</td></tr>
<tr valign="top"><td><code>reorder_method</code></td>
<td>
<p>name of the method used to reorder the matrix.</p>
</td></tr>
</table>
<p>The list may contain additional elements (dendrograms, colors, etc).
</p>


<h3>Author(s)</h3>

<p>Michael Hahsler</p>


<h3>See Also</h3>

<p><code><a href="seriate.html">seriate</a></code>,
<code><a href="pimage.html">pimage</a></code>,
<code><a href="dissplot.html">dissplot</a></code>,
<code><a href="../../gplots/html/heatmap.2.html">heatmap.2</a></code> in <span class="pkg">gplots</span>.</p>


<h3>Examples</h3>

<pre>
data("Wood")

## default heatmap does Euclidean distance, hierarchical clustering with
## average-link and optimal leaf ordering
hmap(Wood)  
  
## heatmap with correlation-based distance, green-red color (greenred is 
## predefined) and optimal leaf ordering and no row label
dist_cor &lt;- function(x) as.dist(1-cor(t(x)))
  
hmap(Wood, method="OLO", distfun = dist_cor, col=greenred(100), labRow=FALSE)
  
## order-based heatmap
hmap(Wood, method="MDS_angle", distfun = dist_cor, col=greenred(100))  

## order-based with dissimilarity matrices
hmap(Wood, method="MDS_angle", distfun = dist_cor, showdist = "both", 
  col=greenred(100))  
</pre>

<hr /><div style="text-align: center;">[Package <em>seriation</em> version 1.2-3 <a href="00Index.html">Index</a>]</div>
</body></html>
