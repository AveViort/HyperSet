<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Cluster validation statistics</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for cluster.stats {fpc}"><tr><td>cluster.stats {fpc}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Cluster validation statistics</h2>

<h3>Description</h3>

<p>Computes a number of distance based statistics, which can be used for cluster
validation, comparison between clusterings and decision about
the number of clusters: cluster sizes, cluster diameters,
average distances within and between clusters, cluster separation,
biggest within cluster gap, 
average silhouette widths, the Calinski and Harabasz index,
a Pearson version of
Hubert's gamma coefficient, the Dunn index and two indexes
to assess the similarity of two clusterings, namely the corrected Rand
index and Meila's VI.
</p>


<h3>Usage</h3>

<pre>
cluster.stats(d = NULL, clustering, alt.clustering = NULL,
                           noisecluster=FALSE,
                              silhouette = TRUE, G2 = FALSE, G3 = FALSE,
                              wgap=TRUE, sepindex=TRUE, sepprob=0.1,
                              sepwithnoise=TRUE,
                              compareonly = FALSE,
                              aggregateonly = FALSE)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>d</code></td>
<td>
<p>a distance object (as generated by <code>dist</code>) or a distance
matrix between cases.</p>
</td></tr>
<tr valign="top"><td><code>clustering</code></td>
<td>
<p>an integer vector of length of the number of cases,
which indicates a clustering. The clusters have to be numbered
from 1 to the number of clusters.</p>
</td></tr>
<tr valign="top"><td><code>alt.clustering</code></td>
<td>
<p>an integer vector such as for
<code>clustering</code>, indicating an alternative clustering. If provided, the
corrected Rand index and Meila's VI for <code>clustering</code>
vs. <code>alt.clustering</code> are computed.</p>
</td></tr>
<tr valign="top"><td><code>noisecluster</code></td>
<td>
<p>logical. If <code>TRUE</code>, it is assumed that the
largest cluster number in <code>clustering</code> denotes a 'noise
class', i.e. points that do not belong to any cluster. These points
are not taken into account for the computation of all functions of
within and between cluster distances including the validation
indexes.</p>
</td></tr> 
<tr valign="top"><td><code>silhouette</code></td>
<td>
<p>logical. If <code>TRUE</code>, the silhouette statistics
are computed, which requires package <code>cluster</code>.</p>
</td></tr>
<tr valign="top"><td><code>G2</code></td>
<td>
<p>logical. If <code>TRUE</code>, Goodman and Kruskal's index G2
(cf. Gordon (1999), p. 62) is computed. This executes lots of
sorting algorithms and can be very slow (it has been improved
by R. Francois - thanks!)</p>
</td></tr>
<tr valign="top"><td><code>G3</code></td>
<td>
<p>logical. If <code>TRUE</code>, the index G3
(cf. Gordon (1999), p. 62) is computed. This executes <code>sort</code>
on all distances and can be extremely slow.</p>
</td></tr>
<tr valign="top"><td><code>wgap</code></td>
<td>
<p>logical. If <code>TRUE</code>, the widest within-cluster gaps
(largest link in within-cluster minimum spanning tree) are
computed. This is used for finding a good number of clusters in
Hennig (2013).</p>
</td></tr>
<tr valign="top"><td><code>sepindex</code></td>
<td>
<p>logical. If <code>TRUE</code>, a separation index is
computed, defined based on the distances for every point to the
closest point not in the same cluster. The separation index is then
the mean of the smallest proportion <code>sepprob</code> of these. This
allows to formalise separation less sensitive to a single or a few
ambiguous points. The output component corresponding to this is
<code>sindex</code>, not <code>separation</code>! This is used for finding a
good number of clusters in Hennig (2013).
</p>
</td></tr>
<tr valign="top"><td><code>sepprob</code></td>
<td>
<p>numerical between 0 and 1, see <code>sepindex</code>.</p>
</td></tr>
<tr valign="top"><td><code>sepwithnoise</code></td>
<td>
<p>logical. If <code>TRUE</code> and <code>sepindex</code> and
<code>noisecluster</code> are both <code>TRUE</code>, the noise points are
incorporated as cluster in the separation index (<code>sepindex</code>)
computation. Also
they are taken into account for the computation for the minimum
cluster separation.</p>
</td></tr> 
<tr valign="top"><td><code>compareonly</code></td>
<td>
<p>logical. If <code>TRUE</code>, only the corrected Rand index
and Meila's VI are
computed and given out (this requires <code>alt.clustering</code> to be
specified).</p>
</td></tr>
<tr valign="top"><td><code>aggregateonly</code></td>
<td>
<p>logical. If <code>TRUE</code> (and not
<code>compareonly</code>), no clusterwise but only aggregated information
is given out (this cuts the size of the output down a bit).</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>cluster.stats</code> returns a list containing the components
<code>n, cluster.number, cluster.size,  min.cluster.size, noisen,
    diameter,
    average.distance, median.distance, separation, average.toother,
    separation.matrix, average.between, average.within,
    n.between, n.within, within.cluster.ss, clus.avg.silwidths, avg.silwidth,
    g2, g3, pearsongamma, dunn, entropy, wb.ratio, ch,
    corrected.rand, vi</code> except if <code>compareonly=TRUE</code>, in which case
only the last two components are computed.
</p>
<table summary="R valueblock">
<tr valign="top"><td><code>n</code></td>
<td>
<p>number of cases.</p>
</td></tr>
<tr valign="top"><td><code>cluster.number</code></td>
<td>
<p>number of clusters.</p>
</td></tr>
<tr valign="top"><td><code>cluster.size</code></td>
<td>
<p>vector of cluster sizes (number of points).</p>
</td></tr>
<tr valign="top"><td><code>min.cluster.size</code></td>
<td>
<p>size of smallest cluster.</p>
</td></tr>
<tr valign="top"><td><code>noisen</code></td>
<td>
<p>number of noise points, see argument <code>noisecluster</code>
(<code>noisen=0</code> if <code>noisecluster=FALSE</code>).</p>
</td></tr>
<tr valign="top"><td><code>diameter</code></td>
<td>
<p>vector of cluster diameters (maximum within cluster
distances).</p>
</td></tr>
<tr valign="top"><td><code>average.distance</code></td>
<td>
<p>vector of clusterwise
within cluster average distances.</p>
</td></tr>
<tr valign="top"><td><code>median.distance</code></td>
<td>
<p>vector of clusterwise
within cluster distance medians.</p>
</td></tr>
<tr valign="top"><td><code>separation</code></td>
<td>
<p>vector of clusterwise minimum distances of a point
in the cluster to a point of another cluster.</p>
</td></tr>
<tr valign="top"><td><code>average.toother</code></td>
<td>
<p>vector of clusterwise average distances of a point
in the cluster to the points of other clusters.</p>
</td></tr>
<tr valign="top"><td><code>separation.matrix</code></td>
<td>
<p>matrix of separation values between all pairs
of clusters.</p>
</td></tr>
<tr valign="top"><td><code>ave.between.matrix</code></td>
<td>
<p>matrix of mean dissimilarities between
points of every pair of clusters.</p>
</td></tr>
<tr valign="top"><td><code>average.between</code></td>
<td>
<p>average distance between clusters.</p>
</td></tr>
<tr valign="top"><td><code>average.within</code></td>
<td>
<p>average distance within clusters.</p>
</td></tr>
<tr valign="top"><td><code>n.between</code></td>
<td>
<p>number of distances between clusters.</p>
</td></tr>
<tr valign="top"><td><code>n.within</code></td>
<td>
<p>number of distances within clusters.</p>
</td></tr>
<tr valign="top"><td><code>max.diameter</code></td>
<td>
<p>maximum cluster diameter.</p>
</td></tr>
<tr valign="top"><td><code>min.separation</code></td>
<td>
<p>minimum cluster separation.</p>
</td></tr>
<tr valign="top"><td><code>within.cluster.ss</code></td>
<td>
<p>a generalisation of the within clusters sum
of squares (k-means objective function), which is obtained if
<code>d</code> is a Euclidean distance matrix.  For general distance
measures, this is half
the sum of the within cluster squared dissimilarities divided by the
cluster size.</p>
</td></tr>
<tr valign="top"><td><code>clus.avg.silwidths</code></td>
<td>
<p>vector of cluster average silhouette
widths. See
<code><a href="../../cluster/html/silhouette.html">silhouette</a></code>.</p>
</td></tr>
<tr valign="top"><td><code>avg.silwidth</code></td>
<td>
<p>average silhouette
width. See
<code><a href="../../cluster/html/silhouette.html">silhouette</a></code>.</p>
</td></tr>
<tr valign="top"><td><code>g2</code></td>
<td>
<p>Goodman and Kruskal's Gamma coefficient. See Milligan and
Cooper (1985), Gordon (1999, p. 62).</p>
</td></tr>
<tr valign="top"><td><code>g3</code></td>
<td>
<p>G3 coefficient. See Gordon (1999, p. 62).</p>
</td></tr>
<tr valign="top"><td><code>pearsongamma</code></td>
<td>
<p>correlation between distances and a
0-1-vector where 0 means same cluster, 1 means different clusters.
&quot;Normalized gamma&quot; in Halkidi et al. (2001).</p>
</td></tr>
<tr valign="top"><td><code>dunn</code></td>
<td>
<p>minimum separation / maximum diameter. Dunn index, see
Halkidi et al. (2002).</p>
</td></tr>
<tr valign="top"><td><code>dunn2</code></td>
<td>
<p>minimum average dissimilarity between two cluster /
maximum average within cluster dissimilarity, another version of
the family of Dunn indexes.</p>
</td></tr> 
<tr valign="top"><td><code>entropy</code></td>
<td>
<p>entropy of the distribution of cluster memberships,
see Meila(2007).</p>
</td></tr>
<tr valign="top"><td><code>wb.ratio</code></td>
<td>
<p><code>average.within/average.between</code>.</p>
</td></tr>
<tr valign="top"><td><code>ch</code></td>
<td>
<p>Calinski and Harabasz index (Calinski and Harabasz 1974,
optimal in Milligan and Cooper 1985; generalised for dissimilarites
in Hennig and Liao 2013).</p>
</td></tr>
<tr valign="top"><td><code>cwidegap</code></td>
<td>
<p>vector of widest within-cluster gaps.</p>
</td></tr>
<tr valign="top"><td><code>widestgap</code></td>
<td>
<p>widest within-cluster gap.</p>
</td></tr>
<tr valign="top"><td><code>sindex</code></td>
<td>
<p>separation index, see argument <code>sepindex</code>.</p>
</td></tr>
<tr valign="top"><td><code>corrected.rand</code></td>
<td>
<p>corrected Rand index (if <code>alt.clustering</code>
has been specified), see Gordon (1999, p. 198).</p>
</td></tr>
<tr valign="top"><td><code>vi</code></td>
<td>
<p>variation of information (VI) index (if <code>alt.clustering</code>
has been specified), see Meila (2007).</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Because <code>cluster.stats</code> processes a full dissimilarity matrix, it
isn't suitable for large data sets. You may consider
<code><a href="distcritmulti.html">distcritmulti</a></code> in that case.
</p>


<h3>Author(s)</h3>

<p>Christian Hennig
<a href="mailto:c.hennig@ucl.ac.uk">c.hennig@ucl.ac.uk</a>
<a href="http://www.homepages.ucl.ac.uk/~ucakche/">http://www.homepages.ucl.ac.uk/~ucakche/</a>
</p>


<h3>References</h3>

<p>Calinski, T., and Harabasz, J. (1974) A Dendrite Method for Cluster 
Analysis, <em>Communications in Statistics</em>, 3, 1-27.
</p>
<p>Gordon, A. D. (1999) <em>Classification</em>, 2nd ed. Chapman and Hall.
</p>
<p>Halkidi, M., Batistakis, Y., Vazirgiannis, M. (2001) On Clustering
Validation Techniques, <em>Journal of Intelligent Information
Systems</em>, 17, 107-145.
</p>
<p>Hennig, C. and Liao, T. (2013) How to find an appropriate clustering
for mixed-type variables with application to socio-economic
stratification, <em>Journal of the Royal Statistical Society, Series
C Applied Statistics</em>, 62, 309-369.
</p>
<p>Hennig, C. (2013) How many bee species? A case study in
determining the number of clusters. In: Spiliopoulou, L. Schmidt-Thieme, R. Janning (eds.): &quot;Data Analysis, Machine Learning and Knowledge Discovery&quot;, Springer, Berlin, 41-49. 
</p>
<p>Kaufman, L. and Rousseeuw, P.J. (1990). &quot;Finding Groups in Data:
An Introduction to Cluster Analysis&quot;. Wiley, New York.
</p>
<p>Meila, M. (2007) Comparing clusterings?an information based distance,
<em>Journal of Multivariate Analysis</em>, 98, 873-895.
</p>
<p>Milligan, G. W. and Cooper, M. C. (1985) An examination of procedures
for determining the number of clusters. <em>Psychometrika</em>, 50, 159-179.
</p>


<h3>See Also</h3>

<p><code><a href="../../cluster/html/silhouette.html">silhouette</a></code>, <code><a href="../../stats/html/dist.html">dist</a></code>, <code><a href="calinhara.html">calinhara</a></code>,
<code><a href="distcritmulti.html">distcritmulti</a></code>.
<code><a href="clusterboot.html">clusterboot</a></code> computes clusterwise stability statistics by
resampling.
</p>


<h3>Examples</h3>

<pre>  
  set.seed(20000)
  options(digits=3)
  face &lt;- rFace(200,dMoNo=2,dNoEy=0,p=2)
  dface &lt;- dist(face)
  complete3 &lt;- cutree(hclust(dface),3)
  cluster.stats(dface,complete3,
                alt.clustering=as.integer(attr(face,"grouping")))
  
</pre>

<hr /><div style="text-align: center;">[Package <em>fpc</em> version 2.1-11.1 <a href="00Index.html">Index</a>]</div>
</body></html>
