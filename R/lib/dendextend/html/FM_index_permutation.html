<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Calculating Fowlkes-Mallows Index under H0</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for FM_index_permutation {dendextend}"><tr><td>FM_index_permutation {dendextend}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Calculating Fowlkes-Mallows Index under H0</h2>

<h3>Description</h3>

<p>Calculating Fowlkes-Mallows index under the null hypothesis of no relation
between the clusterings (random order of the items labels).
</p>


<h3>Usage</h3>

<pre>
FM_index_permutation(A1_clusters, A2_clusters,
  warn = dendextend_options("warn"), ...)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>A1_clusters</code></td>
<td>
<p>a numeric vector of cluster grouping (numeric) of items,
with a name attribute of item name for each element from group A1.
These are often obtained by using some k cut on a dendrogram.</p>
</td></tr>
<tr valign="top"><td><code>A2_clusters</code></td>
<td>
<p>a numeric vector of cluster grouping (numeric) of items,
with a name attribute of item name for each element from group A2.
These are often obtained by using some k cut on a dendrogram.</p>
</td></tr>
<tr valign="top"><td><code>warn</code></td>
<td>
<p>logical (default from dendextend_options(&quot;warn&quot;) is FALSE).
Set if warning are to be issued, it is safer to keep this at TRUE,
but for keeping the noise down, the default is FALSE.</p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
<p>Ignored (passed to FM_index_R/FM_index_profdpm).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The Fowlkes-Mallows index between two vectors of clustering groups.
Under H0. (a double without attr)
</p>


<h3>References</h3>

<p>Fowlkes, E. B.; Mallows, C. L. (1 September 1983).
&quot;A Method for Comparing Two Hierarchical Clusterings&quot;.
Journal of the American Statistical Association 78 (383): 553.
</p>
<p><a href="http://en.wikipedia.org/wiki/Fowlkes-Mallows_index">http://en.wikipedia.org/wiki/Fowlkes-Mallows_index</a>
</p>


<h3>See Also</h3>

<p><a href="cor_bakers_gamma.html">cor_bakers_gamma</a>, <code><a href="FM_index_profdpm.html">FM_index_profdpm</a></code>, 
<code><a href="FM_index_R.html">FM_index_R</a></code>, <code><a href="FM_index.html">FM_index</a></code>
</p>


<h3>Examples</h3>

<pre>

## Not run: 

set.seed(23235)
ss &lt;- TRUE # sample(1:150, 10 )
hc1 &lt;- hclust(dist(iris[ss,-5]), "com")
hc2 &lt;- hclust(dist(iris[ss,-5]), "single")
# dend1 &lt;- as.dendrogram(hc1)
# dend2 &lt;- as.dendrogram(hc2)
#    cutree(dend1)   

# small k
A1_clusters &lt;- cutree(hc1, k=3) # will give a right tailed distribution
# large k
A1_clusters &lt;- cutree(hc1, k=50) # will give a discrete distribution
# "medium" k
A1_clusters &lt;- cutree(hc1, k=25) # gives almost the normal distribution!
A2_clusters &lt;- A1_clusters

R &lt;- 10000
set.seed(414130)
FM_index_H0 &lt;- replicate(R, FM_index_permutation(A1_clusters, A2_clusters)) # can take 10 sec
plot(density(FM_index_H0), main = "FM Index distribution under H0\n (10000 permutation)")
abline(v = mean(FM_index_H0), col = 1, lty = 2)
# The permutation distribution is with a heavy right tail:
library(psych)
skew(FM_index_H0) # 1.254
kurtosi(FM_index_H0) # 2.5427

mean(FM_index_H0); var(FM_index_H0)
the_FM_index &lt;- FM_index(A1_clusters, A2_clusters)
the_FM_index
our_dnorm &lt;- function(x) {
   dnorm(x, mean = attr(the_FM_index, "E_FM"), 
         sd = sqrt(attr(the_FM_index, "V_FM")))
}
# our_dnorm(0.35)
curve(our_dnorm,
      col = 4,
      from = -1,to=1,n=R,add = TRUE)
abline(v = attr(the_FM_index, "E_FM"), col = 4, lty = 2)

legend("topright", legend = c("asymptotic", "permutation"), fill = c(4,1))

## End(Not run)
</pre>

<hr /><div style="text-align: center;">[Package <em>dendextend</em> version 1.9.0 <a href="00Index.html">Index</a>]</div>
</body></html>
