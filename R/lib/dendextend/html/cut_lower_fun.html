<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Cut a dendrogram - and run a function on the output</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for cut_lower_fun {dendextend}"><tr><td>cut_lower_fun {dendextend}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Cut a dendrogram - and run a function on the output</h2>

<h3>Description</h3>

<p>Cuts the dend at height h and returns a list with the FUN function
implemented on all the sub trees created by cut at height h.
This is used for creating a <a href="cutree.dendrogram.html">cutree.dendrogram</a> function,
by using the <code>labels</code> function as FUN.
</p>
<p>This is the Rcpp version of the function, offering a 10-60 times improvement
in speed (depending on the tree size it is used on).
</p>


<h3>Usage</h3>

<pre>
cut_lower_fun(dend, h, FUN = labels, warn = dendextend_options("warn"), ...)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>dend</code></td>
<td>
<p>a dendrogram object.</p>
</td></tr>
<tr valign="top"><td><code>h</code></td>
<td>
<p>a scalar of height to cut the dend by.</p>
</td></tr>
<tr valign="top"><td><code>FUN</code></td>
<td>
<p>a function to run. (default is &quot;labels&quot;)</p>
</td></tr>
<tr valign="top"><td><code>warn</code></td>
<td>
<p>logical (default from dendextend_options(&quot;warn&quot;) is FALSE).
Set if warning are to be issued, it is safer to keep this at TRUE,
but for keeping the noise down, the default is FALSE.
Should the user be warned if reverting to default?</p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
<p>passed to FUN.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the output of running FUN on each of the 
sub dends derived from cutting &quot;dend&quot;
</p>


<h3>Author(s)</h3>

<p>Tal Galili
</p>


<h3>See Also</h3>

<p><code><a href="../../base/html/labels.html">labels</a></code>, <code><a href="../../stats/html/dendrogram.html">dendrogram</a></code>,
<a href="cutree.dendrogram.html">cutree.dendrogram</a>
</p>


<h3>Examples</h3>

<pre>

dend = as.dendrogram(hclust(dist(iris[1:4,-5])))
# this is really cool!
cut_lower_fun(dend, .4, labels)
lapply(cut(dend, h = .4)$lower, labels)   
cut_lower_fun(dend, .4, order.dendrogram)


## Not run: 
# library(dendextend)
library(dendextendRcpp)
dend_big = as.dendrogram(hclust(dist(iris[1:150,-5])))
library(microbenchmark)
microbenchmark(old_cut_lower_fun(dend_big,.1),
               dendextendRcpp::dendextendRcpp_cut_lower_fun(dend_big,.1),
               times = 100)
# about 7-15 times faster. It is faster the larger the tree is, and the lower h is.

## End(Not run)

</pre>

<hr /><div style="text-align: center;">[Package <em>dendextend</em> version 1.9.0 <a href="00Index.html">Index</a>]</div>
</body></html>
