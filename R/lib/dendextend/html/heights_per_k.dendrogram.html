<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Which height will result in which k for a dendrogram</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for heights_per_k.dendrogram {dendextend}"><tr><td>heights_per_k.dendrogram {dendextend}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Which height will result in which k for a dendrogram</h2>

<h3>Description</h3>

<p>Which height will result in which k for a dendrogram.
This helps with speeding up the <a href="cutree-methods.html">cutree.dendrogram</a> function.
</p>


<h3>Usage</h3>

<pre>
heights_per_k.dendrogram(dend, ...)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>dend</code></td>
<td>
<p>a dendrogram.</p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
<p>not used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a vector of heights, with its names being the k clusters that will
result for cutting the dendrogram at each height.
</p>


<h3>Examples</h3>

<pre>
## Not run: 
hc &lt;- hclust(dist(USArrests[1:4,]), "ave")
dend &lt;- as.dendrogram(hc)
heights_per_k.dendrogram(dend)
##       1        2        3        4 
##86.47086 68.84745 45.98871 28.36531 

cutree(hc, h = 68.8) # and indeed we get 2 clusters

unbranch_dend &lt;- unbranch(dend,2)
plot(unbranch_dend)
heights_per_k.dendrogram(unbranch_dend)
       #1        3        4 
       #97.90023 57.41808 16.93594 
       # we do NOT have a height for k=2 because of the tree's structure.
       
   
library(microbenchmark)
dend = as.dendrogram(hclust(dist(iris[1:150,-5])))
dend = as.dendrogram(hclust(dist(iris[1:30,-5])))
dend = as.dendrogram(hclust(dist(iris[1:3,-5])))
microbenchmark(
   #    dendextendRcpp::heights_per_k.dendrogram(dend),
   dendextendRcpp::dendextendRcpp_heights_per_k.dendrogram(dend),
   dendextendRcpp::old_heights_per_k.dendrogram(dend)
)
# improvment is 10 times faster (in Rcpp) for a tree of size 3
# 76 times faster for a tree of size 30
# And:
# 134 times faster for a tree of size 150!!

## End(Not run)
</pre>

<hr /><div style="text-align: center;">[Package <em>dendextend</em> version 1.9.0 <a href="00Index.html">Index</a>]</div>
</body></html>
