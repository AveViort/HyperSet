<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Plot Data on 3D Globes</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for globejs {threejs}"><tr><td>globejs {threejs}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Plot Data on 3D Globes</h2>

<h3>Description</h3>

<p>Plot points, arcs and images on a globe in 3D using Three.js. The globe
can be rotated and and zoomed.
</p>


<h3>Usage</h3>

<pre>
globejs(img = system.file("images/world.jpg", package = "threejs"), lat, long,
  value = 40, color = "#00ffff", arcs, arcsColor = "#99aaff",
  arcsHeight = 0.4, arcsLwd = 1, arcsOpacity = 0.2, atmosphere = FALSE,
  bg = "black", height = NULL, width = NULL, ...)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>img</code></td>
<td>
<p>A character string representing a file path or URI of an image to plot on the globe surface.</p>
</td></tr>
<tr valign="top"><td><code>lat</code></td>
<td>
<p>Optional data point decimal latitudes, must be of same length as <code>long</code>
(negative values indicate south, positive north).</p>
</td></tr>
<tr valign="top"><td><code>long</code></td>
<td>
<p>Optional data point decimal longitudes, must be of same length as <code>lat</code>
(negative values indicate west, positive east).</p>
</td></tr>
<tr valign="top"><td><code>value</code></td>
<td>
<p>Either a single value indicating the height of all data points, or a vector of
values of the same length as <code>lat</code> indicating height of each point.</p>
</td></tr>
<tr valign="top"><td><code>color</code></td>
<td>
<p>Either a single color value indicating the color of all data points, or a
vector of values of the same length as <code>lat</code> indicating color of each point.</p>
</td></tr>
<tr valign="top"><td><code>arcs</code></td>
<td>
<p>Optional four-column data frame specifying arcs to plot. The columns of the data frame,
in order, must indicate the starting latitude, starting longitude, ending latitude, and ending longitude.</p>
</td></tr>
<tr valign="top"><td><code>arcsColor</code></td>
<td>
<p>Either a single color value indicating the color of all arcs, or a vector of values
of the same length as the number of rows of <code>arcs</code>.</p>
</td></tr>
<tr valign="top"><td><code>arcsHeight</code></td>
<td>
<p>A single value between 0 and 1 controlling the height above the globe of each arc.</p>
</td></tr>
<tr valign="top"><td><code>arcsLwd</code></td>
<td>
<p>Either a single value indicating the line width of all arcs, or a vector of values of
the same length as the number of rows of <code>arcs</code>.</p>
</td></tr>
<tr valign="top"><td><code>arcsOpacity</code></td>
<td>
<p>A single value between 0 and 1 indicating the opacity of all arcs.</p>
</td></tr>
<tr valign="top"><td><code>atmosphere</code></td>
<td>
<p>TRUE enables WebGL atmpsphere effect.</p>
</td></tr>
<tr valign="top"><td><code>bg</code></td>
<td>
<p>Plot background color.</p>
</td></tr>
<tr valign="top"><td><code>height</code></td>
<td>
<p>The container div height.</p>
</td></tr>
<tr valign="top"><td><code>width</code></td>
<td>
<p>The container div width.</p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
<p>Additional arguments to pass to the three.js renderer (see
below for more information on these options).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An htmlwidget object (displayed using the object's show or print method).
</p>


<h3>Available rendering options</h3>


<ul>
<li><p>&quot;bodycolor&quot; The diffuse reflective color of the globe.
</p>
</li>
<li><p>&quot;emissive&quot; The emissive color of the globe object.
</p>
</li>
<li><p>&quot;lightcolor&quot; The color of the ambient light in the scene.
</p>
</li>
<li><p>&quot;fov&quot; The initial field of view, default is 35.
</p>
</li>
<li><p>&quot;rotationlat&quot; The initial globe latitudinal rotation in radians, default is 0.
</p>
</li>
<li><p>&quot;rotationlong&quot; The initial globe longitudinal rotation in radians, default is 0.
</p>
</li>
<li><p>&quot;pointsize&quot; The numeric size of the points/bars, default is 1.
</p>
</li>
<li><p>&quot;renderer&quot; Manually set the three.js renderer to one of 'auto' or 'canvas'.
The canvas renderer works across a greater variety of
viewers and browsers. The default setting of 'auto' automatically chooses
WebGL rendering if it's available.
</p>
</li></ul>

<p>Specify colors with standard color names or hex color representations.
The default values (well-suited to many earth-like map images) are
<code>lightcolor = "#aaeeff"</code>, <code>emissive = "#000000"</code>, and <code>bodycolor = "#ffffff"</code>.
Larger <code>fov</code> values result in a smaller (zoomed out) globe.
The latitude and longitude rotation values are relative to the center of
the map image. Their default values of zero radians result in the front of the
globe corresponding to the center of the flat map image.
</p>


<h3>Note</h3>

<p>The <code>img</code> argument specifies the WebGL texture image to wrap on a
sphere. If you plan to plot points using <code>lat</code> and <code>lon</code>
the image must be a plate carree (aka lat/long) equirectangular
map projection; see
<a href="https://en.wikipedia.org/wiki/Equirectangular_projection">https://en.wikipedia.org/wiki/Equirectangular_projection</a> for
details.
Lat/long maps are commonly found for most planetary bodies in the
solar system, and are also easily generated directly in R
(see the references and examples below).
</p>


<h3>References</h3>

<p>The three.js project <a href="http://threejs.org">http://threejs.org</a>.
(The corresponding three.js javascript file is in
<code> system.file("htmlwidgets/globejs",package="threejs")</code>.)
</p>
<p>An excellent overview of available map coordinate reference systems (PDF):
<a href="https://www.nceas.ucsb.edu/~frazier/RSpatialGuides/OverviewCoordinateReferenceSystems.pdf">https://www.nceas.ucsb.edu/~frazier/RSpatialGuides/OverviewCoordinateReferenceSystems.pdf</a>
</p>


<h3>Examples</h3>

<pre>
# Plot flights to frequent destinations from Callum Prentice's
# global flight data set,
# http://callumprentice.github.io/apps/flight_stream/index.html
data(flights)
# Approximate locations as factors
dest   &lt;- factor(sprintf("%.2f:%.2f",flights[,3], flights[,4]))
# A table of destination frequencies
freq &lt;- sort(table(dest), decreasing=TRUE)
# The most frequent destinations in these data, possibly hub airports?
frequent_destinations &lt;- names(freq)[1:10]
# Subset the flight data by destination frequency
idx &lt;- dest %in% frequent_destinations
frequent_flights &lt;- flights[idx, ]
# Lat/long and counts of frequent flights
ll &lt;- unique(frequent_flights[,3:4])
# Plot frequent destinations as bars, and the flights to and from
# them as arcs. Adjust arc width and color by frequency.
globejs(lat=ll[,1], long=ll[,2], arcs=frequent_flights, bodycolor="#aaaaff",
        arcsHeight=0.3, arcsLwd=2, arcsColor="#ffff00", arcsOpacity=0.15,
        atmosphere=TRUE, color="#00aaff", pointsize=0.5)

## Not run: 
# Plot populous world cities from the maps package.
library(threejs)
library(maps)
data(world.cities, package="maps")
cities &lt;- world.cities[order(world.cities$pop, decreasing=TRUE)[1:1000],]
value  &lt;- 100 * cities$pop / max(cities$pop)
col &lt;- colorRampPalette(c("cyan", "lightgreen"))(10)[floor(10 * value/100) + 1]
globejs(lat=cities$lat, long=cities$long, value=value, color=col, atmosphere=TRUE)

# Plot the data on the moon:
moon &lt;- system.file("images/moon.jpg", package="threejs")
globejs(img=moon, bodycolor="#555555", lightcolor="#aaaaaa",
        lat=cities$lat, long=cities$long,
        value=value, color=col)

# Using global plots from the maptools, rworldmap, or sp packages.

# Instead of using ready-made images of the earth, we can use
# many R spatial imaging packages to produce globe images
# dynamically. With a little extra effort you can build globes with total
# control over how they are plotted.

library(maptools)
library(threejs)
data(wrld_simpl)

bgcolor &lt;- "#000025"
earth &lt;- tempfile(fileext=".jpg")

# NOTE: Use antialiasing to smooth border boundary lines. But! Set the jpeg
# background color to the globe background color to avoid a visible aliasing
# effect at the the plot edges.

jpeg(earth, width=2048, height=1024, quality=100, bg=bgcolor, antialias="default")
par(mar = c(0,0,0,0), pin = c(4,2), pty = "m",  xaxs = "i",
    xaxt = "n",       xpd = FALSE,  yaxs = "i", bty = "n", yaxt = "n")
plot(wrld_simpl, col="black", bg=bgcolor, border="cyan", ann=FALSE,
     setParUsrBB=TRUE)
dev.off()
globejs(earth)

# A shiny example:
shiny::runApp(system.file("examples/globe",package="threejs"))

## End(Not run)

# See http://bwlewis.github.io/rthreejs for additional examples.
</pre>

<hr /><div style="text-align: center;">[Package <em>threejs</em> version 0.3.1 <a href="00Index.html">Index</a>]</div>
</body></html>
