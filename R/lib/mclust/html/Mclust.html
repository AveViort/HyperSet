<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Model-Based Clustering</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for Mclust {mclust}"><tr><td>Mclust {mclust}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Model-Based Clustering</h2>

<h3>Description</h3>

<p>Model-based clustering based on parameterized finite Gaussian mixture models. 
Models are estimated by EM algorithm initialized by hierarchical model-based agglomerative clustering. The optimal model is then selected according to BIC.
</p>


<h3>Usage</h3>

<pre>
Mclust(data, G = NULL, modelNames = NULL, 
       prior = NULL, 
       control = emControl(), 
       initialization = NULL, 
       warn = mclust.options("warn"), 
       x =  NULL, 
       verbose = interactive(), ...)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>data</code></td>
<td>

<p>A numeric vector, matrix, or data frame of observations. Categorical
variables are not allowed. If a matrix or data frame, rows
correspond to observations and columns correspond to variables. 
</p>
</td></tr>
<tr valign="top"><td><code>G</code></td>
<td>

<p>An integer vector specifying the numbers of mixture components
(clusters) for which the BIC is to be calculated. 
The default is <code>G=1:9</code>. 
</p>
</td></tr>
<tr valign="top"><td><code>modelNames</code></td>
<td>

<p>A vector of character strings indicating the models to be fitted 
in the EM phase of clustering. The default is:
</p>

<table summary="Rd table">
<tr>
 <td style="text-align: left;">
    for univariate data </td><td style="text-align: left;"> <code>c("E", "V")</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
    for multivariate data (<i>n &gt; d</i>) </td><td style="text-align: left;"> <code>mclust.options("emModelNames")</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
    for multivariate data (<i>n &lt;= d</i>) the spherical and diagonal models </td><td style="text-align: left;"> <code>c("EII", "VII", "EEI", "EVI", "VEI", "VVI")</code>
     </td>
</tr>

</table>

<p>The help file for <code><a href="mclustModelNames.html">mclustModelNames</a></code> describes the available models.
</p>
</td></tr>
<tr valign="top"><td><code>prior</code></td>
<td>

<p>The default assumes no prior, but this argument allows specification of a 
conjugate prior on the means and variances through the function 
<code><a href="priorControl.html">priorControl</a></code>. <br />
Note that, as described in <code><a href="defaultPrior.html">defaultPrior</a></code>, in the multivariate 
case only 10 out of 14 models may be used in conjunction with a prior, i.e.
those available in <em>MCLUST</em> up to version 4.4.
</p>
</td></tr>
<tr valign="top"><td><code>control</code></td>
<td>

<p>A list of control parameters for EM. The defaults are set by the call
<code>emControl()</code>. 
</p>
</td></tr>
<tr valign="top"><td><code>initialization</code></td>
<td>

<p>A list containing zero or more of the following components:
</p>

<dl>
<dt><code>hcPairs</code></dt><dd>
<p>A matrix of merge pairs for hierarchical clustering such as produced
by function <code><a href="hc.html">hc</a></code>. <br />
For multivariate data, the default is to compute a hierarchical 
agglomerative clustering tree by applying function 
<code><a href="hc.html">hc</a></code> with 
model specified by <code>mclust.options("hcModelName")</code>, and
data transformation set by <code>mclust.options("hcUse")</code>.<br />
All the input or a subset as indicated by the <code>subset</code> argument is 
used for initial clustering.<br />
The hierarchical clustering results are then used to start the EM
algorithm from a given partition.<br />
For univariate data, the default is to use quantiles to start the EM
algorithm. However, hierarchical clustering could also be used by 
calling <code><a href="hc.html">hc</a></code> with model specified as <code>"V"</code> or <code>"E"</code>.
</p>
</dd>
<dt><code>subset</code></dt><dd>
<p>A logical or numeric vector specifying a subset of the data
to be used in the initial hierarchical clustering phase.
By default no subset is used unless the number of observations exceeds 
the value specified by <code>mclust.options("subset")</code>. Note that to
guarantee exact reproducibility of results a seed must be specified 
(see <code><a href="../../base/html/Random.html">set.seed</a></code>).</p>
</dd>
<dt><code>noise</code></dt><dd>
<p>A logical or numeric vector indicating an initial guess as to
which observations are noise in the data. If numeric the entries
should correspond to row indexes of the data. If supplied, a noise
term will be added to the model in the estimation.</p>
</dd>
</dl>

</td></tr>
<tr valign="top"><td><code>warn</code></td>
<td>

<p>A logical value indicating whether or not certain warnings 
(usually related to singularity) should be issued.
The default is controlled by <code><a href="mclust.options.html">mclust.options</a></code>.
</p>
</td></tr>
<tr valign="top"><td><code>x</code></td>
<td>

<p>An object of class <code>'mclustBIC'</code>. If supplied, BIC values for models 
that have already been computed and are available in <code>x</code> are not 
recomputed. 
All arguments, with the exception of <code>data</code>, <code>G</code> and 
<code>modelName</code>, are ignored and their values are set as specified in the
attributes of <code>x</code>. Defaults for <code>G</code> and <code>modelNames</code>
are taken from <code>x</code>.
</p>
</td></tr>
<tr valign="top"><td><code>verbose</code></td>
<td>

<p>A logical controlling if a text progress bar is displayed during the
fitting procedure. By default is <code>TRUE</code> if the session is 
interactive, and <code>FALSE</code> otherwise..
</p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>

<p>Catches unused arguments in indirect or list calls via <code>do.call</code>.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>'Mclust'</code> providing the optimal (according to BIC)
mixture model estimation.
</p>
<p>The details of the output components are as follows:
</p>
<table summary="R valueblock">
<tr valign="top"><td><code>call</code></td>
<td>
<p>The matched call</p>
</td></tr> 
<tr valign="top"><td><code>data</code></td>
<td>
<p>The input data matrix.</p>
</td></tr> 
<tr valign="top"><td><code>modelName</code></td>
<td>

<p>A character string denoting the model at which the optimal BIC occurs.
</p>
</td></tr>
<tr valign="top"><td><code>n</code></td>
<td>

<p>The number of observations in the data.
</p>
</td></tr>
<tr valign="top"><td><code>d</code></td>
<td>

<p>The dimension of the data.
</p>
</td></tr>
<tr valign="top"><td><code>G</code></td>
<td>

<p>The optimal number of mixture components.
</p>
</td></tr>
<tr valign="top"><td><code>BIC</code></td>
<td>

<p>All BIC values.
</p>
</td></tr>
<tr valign="top"><td><code>bic</code></td>
<td>

<p>Optimal BIC value.
</p>
</td></tr>
<tr valign="top"><td><code>loglik</code></td>
<td>

<p>The log-likelihood corresponding to the optimal BIC.
</p>
</td></tr>
<tr valign="top"><td><code>df</code></td>
<td>

<p>The number of estimated parameters.
</p>
</td></tr>
<tr valign="top"><td><code>hypvol</code></td>
<td>

<p>The hypervolume parameter for the noise component if required, otherwise set to <code>NULL</code> (see <code><a href="hypvol.html">hypvol</a></code>).
</p>
</td></tr>
<tr valign="top"><td><code>parameters</code></td>
<td>

<p>A list with the following components:
</p>

<dl>
<dt><code>pro</code></dt><dd>
<p>A vector whose <em>k</em>th component is the mixing proportion for
the <em>k</em>th component of the mixture model.
If missing, equal proportions are assumed.
</p>
</dd>
<dt><code>mean</code></dt><dd>
<p>The mean for each component. If there is more than one component,
this is a matrix whose kth column is the mean of the <em>k</em>th
component of the mixture model.
</p>
</dd>
<dt><code>variance</code></dt><dd>
<p>A list of variance parameters for the model.
The components of this list depend on the model
specification. See the help file for <code><a href="mclustVariance.html">mclustVariance</a></code>
for details.
</p>
</dd>
</dl>

</td></tr>
<tr valign="top"><td><code>z</code></td>
<td>

<p>A matrix whose <em>[i,k]</em>th entry is the probability that observation
<em>i</em> in the test data belongs to the <em>k</em>th class.
</p>
</td></tr>
<tr valign="top"><td><code>classification</code></td>
<td>

<p>The classification corresponding to <code>z</code>, i.e. <code>map(z)</code>.
</p>
</td></tr>
<tr valign="top"><td><code>uncertainty</code></td>
<td>

<p>The uncertainty associated with the classification.
</p>
</td></tr>
</table>


<h3>References</h3>

<p>Scrucca L., Fop M., Murphy T. B. and Raftery A. E. (2016) mclust 5: clustering, classification and density estimation using Gaussian finite mixture models, <em>The R Journal</em>, 8/1, pp. 205-233. 
</p>
<p>Fraley C. and Raftery A. E. (2002) Model-based clustering, discriminant analysis and density estimation, <em>Journal of the American Statistical Association</em>, 97/458, pp. 611-631.
</p>
<p>Fraley C., Raftery A. E., Murphy T. B. and Scrucca L. (2012) mclust Version 4 for R: Normal Mixture Modeling for Model-Based Clustering, Classification, and Density Estimation. <em>Technical Report</em> No. 597, Department of Statistics, University of Washington.
</p>
<p>C. Fraley and A. E. Raftery (2007) Bayesian regularization for normal mixture estimation and model-based clustering. <em>Journal of Classification</em>, 24, 155-181.
</p>


<h3>See Also</h3>

<p><code><a href="summary.Mclust.html">summary.Mclust</a></code>, 
<code><a href="plot.Mclust.html">plot.Mclust</a></code>, 
<code><a href="priorControl.html">priorControl</a></code>, 
<code><a href="emControl.html">emControl</a></code>, 
<code><a href="hc.html">hc</a></code>,
<code><a href="mclustBIC.html">mclustBIC</a></code>, 
<code><a href="mclustModelNames.html">mclustModelNames</a></code>,
<code><a href="mclust.options.html">mclust.options</a></code>
</p>


<h3>Examples</h3>

<pre>
mod1 &lt;- Mclust(iris[,1:4])
summary(mod1)

mod2 &lt;- Mclust(iris[,1:4], G = 3)
summary(mod2, parameters = TRUE)

# Using prior
mod3 &lt;- Mclust(iris[,1:4], prior = priorControl())
summary(mod3)

mod4 &lt;- Mclust(iris[,1:4], prior = priorControl(functionName="defaultPrior", shrinkage=0.1))
summary(mod4)

# Clustering of faithful data with some artificial noise added 
nNoise &lt;- 100
set.seed(0) # to make it reproducible
Noise &lt;- apply(faithful, 2, function(x) 
                            runif(nNoise, min = min(x)-.1, max = max(x)+.1))
data &lt;- rbind(faithful, Noise)
plot(faithful)
points(Noise, pch = 20, cex = 0.5, col = "lightgrey")
set.seed(0)
NoiseInit &lt;- sample(c(TRUE,FALSE), size = nrow(faithful)+nNoise, 
                    replace = TRUE, prob = c(3,1)/4)
mod5 &lt;- Mclust(data, initialization = list(noise = NoiseInit))
summary(mod5, parameter = TRUE)
plot(mod5, what = "classification")
</pre>

<hr /><div style="text-align: center;">[Package <em>mclust</em> version 5.4.2 <a href="00Index.html">Index</a>]</div>
</body></html>
