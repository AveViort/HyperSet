<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Network Enrichment Analysis (NEA)</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for nea.render {NEArender}"><tr><td>nea.render {NEArender}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Network Enrichment Analysis (NEA)</h2>

<h3>Description</h3>

<p>Given the altered gene sets (AGS), functional gene sets (FGS) and the network, calculates enrichment statistics based on the number of edges (network links) that connect individual genes in each AGS-FGS pair (edges confined within AGS only or FGS only are not taken into account). Returns relevant statistics in matrices of size <code>length(FGS)</code> x <code>length(AGS)</code> (see &quot;Value&quot;). Each of the first three parameters can be submitted as either a text file or as a list which has been preloaded with <code><a href="import.gs.html">import.gs</a></code> and <code><a href="import.net.html">import.net</a></code>. The latter scenario could save much time in a batch mode(see Details).
</p>


<h3>Usage</h3>

<pre>
nea.render(AGS, FGS, NET, Lowercase = 1, ags.gene.col = 2,
  ags.group.col = 3, fgs.gene.col = 2, fgs.group.col = 3,
  net.gene1.col = 1, net.gene2.col = 2, echo = 1, graph = FALSE,
  na.replace = 0, members = FALSE, digitalize = TRUE, Parallelize = 1)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>AGS</code></td>
<td>
<p>Either a text file or a list of members of each AGS (see Details). Group IDs should be found in <code>ags.group.col</code> and gene IDs should be found in <code>ags.gene.col</code>. As a special option, an AGS list can also be pre-created from raw data matrices of the format &quot;genes X samples&quot;. Such matrices can contain information on gene copy number, gene/protein expression, gene methylation etc (<code><a href="samples2ags.html">samples2ags</a></code>) or point mutation data (<code><a href="mutations2ags.html">mutations2ags</a></code>). These two functions return AGS lists of length=ncol(Nsamples).</p>
</td></tr>
<tr valign="top"><td><code>FGS</code></td>
<td>
<p>Either a text file or a list of members of each FGS (see Details). Group IDs should be found in <code>fgs.group.col</code> and gene IDs should be found in <code>fgs.gene.col</code>. As an  alternative, this function can use  single-node FGSs from the network nodes, which should be pre-created with <code><a href="as_genes_fgs.html">as_genes_fgs</a></code>. In this case each network node X becomes an FGS on its own. Respective names in the FGS list equal 'X' and the content becomes c('X'). The total length of the FGS list then equals the no. of nodes in the network. If fewer nodes are needed for such single-node analysis, then one can submit a text file in which <code>fgs.gene.col</code> and <code>fgs.group.col</code> contain identical gene IDs. This option uses <code><a href="as_genes_fgs.html">as_genes_fgs</a></code>.</p>
</td></tr>
<tr valign="top"><td><code>NET</code></td>
<td>
<p>The global network for the analysis (see Details) .</p>
</td></tr>
<tr valign="top"><td><code>Lowercase</code></td>
<td>
<p>render node and group IDs lower-case (default:1, i.e. 'yes').</p>
</td></tr>
<tr valign="top"><td><code>ags.gene.col</code></td>
<td>
<p>number of the column containing AGS genes (only needed if AGS is submitted as a text file).</p>
</td></tr>
<tr valign="top"><td><code>ags.group.col</code></td>
<td>
<p>number of the column containing group IDs (only needed if AGS is submitted as a text file).</p>
</td></tr>
<tr valign="top"><td><code>fgs.gene.col</code></td>
<td>
<p>number of the column containing FGS genes (only needed if FGS is submitted as a text file).</p>
</td></tr>
<tr valign="top"><td><code>fgs.group.col</code></td>
<td>
<p>number of the column containing group IDs (only needed if FGS is submitted as a text file).</p>
</td></tr>
<tr valign="top"><td><code>net.gene1.col</code></td>
<td>
<p>number of the column containing first nodes of each network edge (only needed if NET is submitted as a text file).</p>
</td></tr>
<tr valign="top"><td><code>net.gene2.col</code></td>
<td>
<p>number of the column containing second nodes of each network edge (only needed if NET is submitted as a text file).</p>
</td></tr>
<tr valign="top"><td><code>echo</code></td>
<td>
<p>if messages about execution progress should appear.</p>
</td></tr>
<tr valign="top"><td><code>graph</code></td>
<td>
<p>Plot the heat map</p>
</td></tr>
<tr valign="top"><td><code>na.replace</code></td>
<td>
<p>replace NA values. Default=0, i.e. not to replace</p>
</td></tr>
<tr valign="top"><td><code>members</code></td>
<td>
<p>If matrices <code>members.fgs</code> and <code>members.fgs</code> should be created in addition (time- and memory-consuming). These matrices contain lists of genes that contributed to respective AGSxFGS enrichment statistic.</p>
</td></tr>
<tr valign="top"><td><code>digitalize</code></td>
<td>
<p>If the node ID strings should be converted to internal integer ID, and then back to present the results (can speed up the computation). Since this procedure also takes some time, setting <em>digitalize=TRUE</em> only makes sense for large computations, with a big network, many FGS and/or AGS.</p>
</td></tr>
<tr valign="top"><td><code>Parallelize</code></td>
<td>
<p>The number of CPU cores to be used for the step &quot;Counting actual links&quot; (the other steps are sufficiently fast). The option is not supported on Windows.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>both AGS and FGS can be either <br />
1) a list preloaded from a text file using e.g. GS=import.gs(&quot;text_file.groups&quot;); names of the list entries are gene set IDs and the entries contain gene/protein IDs that belong to the respective set or <br />
2) name of the file &quot;text_file.groups&quot; to be read from the disk using <code><a href="import.gs.html">import.gs</a></code>. <br />
The TAB-delimited file &quot;text_file.groups&quot; should contain pre-compiled gene sets, so that gene set IDs will be found in column <code>ags.group.col</code> / <code>fgs.group.col</code> and gene IDs will be found in <code>ags.gene.col</code> / <code>fgs.gene.col</code>. Option (1) is much more efficient than (2) when <code><a href="nea.render.html">nea.render</a></code> has to be run multiple times. Similarly to AGS and FGS, NET could be submitted as either a list, pre-loaded with <code><a href="import.net.html">import.net</a></code>, or a text TAB-delimited file where two columns <code>net.gene1.col</code> and <code>net.gene2.col</code> represent nodes of respective edges.
</p>


<h3>Value</h3>

<p>An object, i.e. a list of elements <code>n.actual</code>, <code>n.expected</code>, <code>chi</code>, <code>z</code>, <code>p</code>, <code>q</code>, each of which is a matrix of size <code>length(FGS)</code> x <code>length(AGS)</code>. The two former ones contain the number of network edges between any nodes of AGS and any nodes of FGS, respectively those observed in the actual network and expected by chance. <code>chi</code> are the original chi-squared network enrichment statistic values. <code>z</code> are respective z-scores which are normally distributed under null and are thus suitable as input to regression modelling and other parametric methods. <code>p</code> and <code>q</code> are p-values and respective FDR estimates from <code>p.adjust(p, method="BH")</code>.
</p>


<h3>References</h3>

<p><a href="https://bmcbioinformatics.biomedcentral.com/articles/10.1186/s12859-017-1534-y">https://bmcbioinformatics.biomedcentral.com/articles/10.1186/s12859-017-1534-y</a>
</p>


<h3>See Also</h3>

<p><code><a href="samples2ags.html">samples2ags</a></code>
</p>


<h3>Examples</h3>

<pre>
ags.list &lt;- samples2ags(fantom5.43samples, Ntop=20, method="topnorm")
data(can.sig.go)
fpath &lt;- can.sig.go
fgs.list &lt;- import.gs(fpath)
summary(fgs.list)
data(net.kegg)
netpath &lt;- net.kegg
net &lt;- import.net(netpath)
n1 &lt;- nea.render(AGS=ags.list[1:10], FGS=fgs.list[1:10], NET=net, graph=FALSE)
hist(n1$chi, breaks=100)
hist(n1$z, breaks=100)
hist(n1$p, breaks=100)
hist(n1$q, breaks=100)
</pre>

<hr /><div style="text-align: center;">[Package <em>NEArender</em> version 1.5 <a href="00Index.html">Index</a>]</div>
</body></html>
