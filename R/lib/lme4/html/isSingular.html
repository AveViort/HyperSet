<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Test fitted model for (near) singularity</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for isSingular {lme4}"><tr><td>isSingular {lme4}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>
Test fitted model for (near) singularity
</h2>

<h3>Description</h3>

<p>Evaluates whether a fitted mixed model is singular, i.e.
whether variances of one or more linear combinations of effects
are (close to) zero.
</p>


<h3>Usage</h3>

<pre>
isSingular(x, tol = 1e-05)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>x</code></td>
<td>

<p>a fitted <code>merMod</code> object (result of <code>lmer</code> or <code>glmer</code>)
</p>
</td></tr>
<tr valign="top"><td><code>tol</code></td>
<td>

<p>numerical tolerance for detecting singularity
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Complex mixed-effect models (i.e., those with a
large number of variance-covariance parameters) frequently result in
<em>singular</em> fits, i.e. estimated variance-covariance matrices with
less than full rank. Less technically, this means that some
&quot;dimensions&quot; of the variance-covariance matrix have been estimated as
exactly zero. For scalar random effects such as intercept-only models,
or 2-dimensional random effects such as intercept+slope models,
singularity is relatively easy to detect because it leads to
random-effect variance estimates of (nearly) zero, or estimates of
correlations that are (almost) exactly -1 or 1. However, for more
complex models (variance-covariance matrices of dimension 3 and
greater) singularity can be hard to detect; models can be singular
without any of their individual variances or correlations being close
to zero.
</p>
<p>This function performs a simple test to determine whether any of the
random effects covariance matrices of a fitted model are singular.
The <code><a href="rePCA.html">rePCA</a></code> method provides more detail about the
singularity pattern, showing the standard deviations
of orthogonal variance components and the mapping from
variance terms in the model to orthogonal components
(i.e., eigenvector/rotation matrices).
</p>
<p>While singular models are statistically well defined (it is
theoretically sensible for the true maximum likelihood estimate
to correspond to a singular fit), there are real concerns
that (1) singular fits correspond to overfitted models that may
have poor power; (2) chances of numerical problems and mis-convergence
are higher for singular models (e.g. it may be computationally
difficult to compute profile confidence intervals for such
models); (3) standard inferential procedures such as Wald statistics
and likelihood ratio tests may be inappropriate.
</p>
<p>There is not yet consensus about how to deal with singularity, or
more generally to choose which random-effects specification (from
a range of choices of varying complexity) to use.  Some proposals
include:
</p>

<ul>
<li><p> avoid fitting overly complex models in the first place,
i.e. design experiments/restrict models <em>a priori</em> such that the
variance-covariance matrices can be estimated precisely enough
to avoid singularity (Matuschek et al 2017)
</p>
</li>
<li><p> use some form of model selection to choose a model that
balances predictive accuracy and overfitting/type I error
(Bates et al 2015, Matuschek et al 2017)
</p>
</li>
<li> <p>&ldquo;keep it maximal&rdquo;, i.e. fit the most complex
model consistent with the experimental design, removing only
terms required to allow a non-singular fit (Barr et al. 2013)
</p>
</li>
<li><p> use some form of <em>regularization</em> that forces
the model fit away from singularity (Chung et al 2013, <span class="pkg">blme</span>
package)
</p>
</li>
<li><p> use a fully Bayesian method that both regularizes the
model via informative priors and gives estimates
and credible intervals for all parameters that averages
over the uncertainty in the random effects parameters
(Gelman and Hill 2006, McElreath 2015;
<span class="pkg">MCMCglmm</span>, <span class="pkg">rstanarm</span> and <span class="pkg">brms</span> packages)
</p>
</li></ul>
  


<h3>Value</h3>

<p>a logical value 
</p>


<h3>References</h3>


<ul>
<li><p> Dale J. Barr, Roger Levy, Christoph Scheepers, and Harry J. Tily. Random effects structure for confirmatory hypothesis testing: Keep it maximal.
Journal of Memory and Language, 68(3):255–278, April 2013.
</p>
</li>
<li><p> Douglas Bates, Reinhold Kliegl, Shravan Vasishth, and Harald Baayen.
Parsimonious Mixed Models. arXiv:1506.04967 [stat], June 2015. arXiv:
1506.04967.
</p>
</li>
<li><p> Yeojin Chung, Sophia Rabe-Hesketh, Vincent Dorie, Andrew Gelman, and
Jingchen Liu. A nondegenerate penalized likelihood estimator for variance
parameters in multilevel models. Psychometrika, pages 1–25, 2013.
</p>
</li>
<li><p> Andrew Gelman and Jennifer Hill. Data Analysis Using Regression and
Multilevel/Hierarchical Models. Cambridge University Press, Cambridge,
England, 2006.
</p>
</li>
<li><p> Hannes Matuschek, Reinhold Kliegl, Shravan Vasishth, Harald Baayen, and
Douglas Bates. Balancing type I error and power in linear mixed models.
Journal of Memory and Language, 94:305–315, 2017.
</p>
</li>
<li><p> Richard McElreath. Statistical Rethinking: A Bayesian Course with Examples in R and Stan. Chapman and Hall/CRC, Boca Raton, December
2015
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="getME.html">getME</a></code>, <code><a href="rePCA.html">rePCA</a></code></p>

<hr /><div style="text-align: center;">[Package <em>lme4</em> version 1.1-19 <a href="00Index.html">Index</a>]</div>
</body></html>
