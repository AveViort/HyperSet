<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Compute Hartigans' Dip Test Statistic for Unimodality</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for dip {diptest}"><tr><td>dip {diptest}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Compute Hartigans' Dip Test Statistic for Unimodality</h2>

<h3>Description</h3>

<p>Computes Hartigans' dip test statistic for testing unimodality,
and additionally the modal interval.
</p>


<h3>Usage</h3>

<pre>
dip(x, full.result = FALSE, min.is.0 = FALSE, debug = FALSE)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>x</code></td>
<td>
<p>numeric; the data.</p>
</td></tr>
<tr valign="top"><td><code>full.result</code></td>
<td>
<p>logical or string; <code>dip(., full.result=TRUE)</code> returns the full result
list; if <code>"all"</code> it additionally uses the <code>mn</code> and
<code>mj</code> components to compute the initial GCM and LCM, see below.</p>
</td></tr>
<tr valign="top"><td><code>min.is.0</code></td>
<td>
<p>logical indicating if the <b>min</b>imal value of the
dip statistic <i>Dn</i> can be zero or not.  Arguably should be
set to <code>TRUE</code> for internal consistency reasons, but is false by
default both for continuity and backwards compatibility reasons, see
the examples below.</p>
</td></tr>
</table>



<table summary="R argblock">
<tr valign="top"><td><code>debug</code></td>
<td>
<p>logical; if true, some tracing information is printed
(from the C routine).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>depending on <code>full.result</code> either a number, the dip statistic, or
an object of class <code>"dip"</code> which is a <code><a href="../../base/html/list.html">list</a></code> with components
</p>
<table summary="R valueblock">
<tr valign="top"><td><code>x</code></td>
<td>
<p>the sorted <code><a href="../../base/html/unname.html">unname</a>()</code>d data.</p>
</td></tr>
<tr valign="top"><td><code>n</code></td>
<td>
<p><code>length(x)</code>.</p>
</td></tr>
<tr valign="top"><td><code>dip</code></td>
<td>
<p>the dip statistic</p>
</td></tr>
<tr valign="top"><td><code>lo.hi</code></td>
<td>
<p>indices into <code>x</code> for lower and higher end of modal interval</p>
</td></tr>
<tr valign="top"><td><code>xl, xu</code></td>
<td>
<p>lower and upper end of modal interval</p>
</td></tr>
<tr valign="top"><td><code>gcm, lcm</code></td>
<td>
<p>(last used) indices for <b>g</b>reatest <b>c</b>onvex
<b>m</b>inorant and the <b>l</b>east <b>c</b>oncave <b>m</b>ajorant.</p>
</td></tr>
<tr valign="top"><td><code>mn, mj</code></td>
<td>
<p>index vectors of length <code>n</code> for the GC minorant and
the LC majorant respectively.</p>
</td></tr>
</table>
<p>For &ldquo;full&rdquo; results of class <code>"dip"</code>, there are
<code><a href="../../base/html/print.html">print</a></code> and <code><a href="../../graphics/html/plot.html">plot</a></code> methods, the latter with
its own <a href="plot.dip.html">manual page</a>.
</p>


<h3>Note</h3>

<p>For <i>n &lt;= 3</i> where <code>n &lt;- length(x)</code>, the dip
statistic <i>Dn</i> is always the same minimum value,
<i>1/(2n)</i>, i.e., there's no possible dip test.
Note that up to May 2011, from Hartigan's original Fortran code, <code>Dn</code>
was set to zero, when all <code>x</code> values were identical.  However,
this entailed discontinuous behavior, where for arbitrarily close
data <i>x~</i>, <i>Dn(x~) = 1/(2n)</i>.
</p>
<p>Yong Lu <a href="mailto:lyongu+@cs.cmu.edu">lyongu+@cs.cmu.edu</a> found in Oct 2003 that the code
was not giving symmetric results for mirrored data (and was giving
results of almost 1, and then found the reason, a misplaced <span class="samp">")"</span>
in the original Fortran code.  This bug has been corrected for diptest
version 0.25-0.
</p>
<p>Nick Cox (Durham Univ.) said (on March 20, 2008 on the Stata-list):<br />
As it comes from a bimodal husband-wife collaboration, the name
perhaps should be <em>&ldquo;Hartigan-Hartigan dip test&rdquo;</em>, but that
does not seem to have caught on.  Some of my less statistical
colleagues would sniff out the hegemony of patriarchy there, although
which Hartigan is being overlooked is not clear.
</p>
<p>Martin Maechler, as a Swiss, and politician, would say:<br />
Let's find a compromise, and call it <em>&ldquo;Hartigans' dip test&rdquo;</em>,
so we only have to adapt orthography (:-).
</p>


<h3>Author(s)</h3>

<p>Martin Maechler <a href="mailto:maechler@stat.math.ethz.ch">maechler@stat.math.ethz.ch</a>, 1994,
based on S (S-PLUS) and C code donated from Dario Ringach
<a href="mailto:dario@wotan.cns.nyu.edu">dario@wotan.cns.nyu.edu</a> who had applied <code>f2c</code> on the
original Fortran code available from Statlib.
</p>
<p>In Aug.1993, recreated and improved Hartigans' &quot;P-value&quot; table, which
later became <code><a href="qDiptab.html">qDiptab</a></code>.
</p>


<h3>References</h3>

<p>P. M. Hartigan (1985)
Computation of the Dip Statistic to Test for Unimodality;
<em>Applied Statistics (JRSS C)</em> <b>34</b>, 320&ndash;325.<br />
Corresponding (buggy!) Fortran code of &lsquo;AS 217&rsquo; available from Statlib,
<a href="http://lib.stat.cmu.edu/apstat/217">http://lib.stat.cmu.edu/apstat/217</a>
</p>
<p>J. A. Hartigan and P. M. Hartigan (1985)
The Dip Test of Unimodality;
<em>Annals of Statistics</em> <b>13</b>, 70&ndash;84.
</p>


<h3>See Also</h3>

<p><code><a href="dip.test.html">dip.test</a></code> to compute the dip <em>and</em> perform the unimodality test,
based on P-values, interpolated from <code><a href="qDiptab.html">qDiptab</a></code>;
<code><a href="../../stats/html/isoreg.html">isoreg</a></code> for isotonic regression.
</p>


<h3>Examples</h3>

<pre>
data(statfaculty)
plot(density(statfaculty))
rug(statfaculty, col="midnight blue"); abline(h=0, col="gray")
dip(statfaculty)
(dS &lt;- dip(statfaculty, full = TRUE, debug = TRUE))
plot(dS)
## even more output -- + plot showing "global" GCM/LCM:
(dS2 &lt;- dip(statfaculty, full = "all", debug = 3))
plot(dS2)

data(faithful)
fE &lt;- faithful$eruptions
plot(density(fE))
rug(fE, col="midnight blue"); abline(h=0, col="gray")
dip(fE, debug = 2) ## showing internal work
(dE &lt;- dip(fE, full = TRUE)) ## note the print method
plot(dE, do.points=FALSE)

data(precip)
plot(density(precip))
rug(precip, col="midnight blue"); abline(h=0, col="gray")
str(dip(precip, full = TRUE, debug = TRUE))

##-----------------  The  'min.is.0' option :  ---------------------

##' dip(.) continuity and 'min.is.0' exploration:
dd &lt;- function(x, debug=FALSE) {
   x_ &lt;- x ; x_[1] &lt;- 0.9999999999 * x[1]
   rbind(dip(x , debug=debug),
         dip(x_, debug=debug),
         dip(x , min.is.0=TRUE, debug=debug),
         dip(x_, min.is.0=TRUE, debug=debug), deparse.level=2)
}

dd( rep(1, 8) ) # the 3rd one differs ==&gt; min.is.0=TRUE is *dis*continuous
dd( 1:7 )       # ditto

dd( 1:7, debug=TRUE)
## border-line case ..
dd( 1:2, debug=TRUE)

## Demonstrate that  'min.is.0 = TRUE'  does not change the typical result:
B.sim &lt;- 1000 # or larger
D5  &lt;- {set.seed(1); replicate(B.sim, dip(runif(5)))}
D5. &lt;- {set.seed(1); replicate(B.sim, dip(runif(5), min.is.0=TRUE))}
stopifnot(identical(D5, D5.), all.equal(min(D5), 1/(2*5)))
hist(D5, 64); rug(D5)

D8  &lt;- {set.seed(7); replicate(B.sim, dip(runif(8)))}
D8. &lt;- {set.seed(7); replicate(B.sim, dip(runif(8), min.is.0=TRUE))}
stopifnot(identical(D8, D8.))
</pre>

<hr /><div style="text-align: center;">[Package <em>diptest</em> version 0.75-7 <a href="00Index.html">Index</a>]</div>
</body></html>
