<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Mantel Test for Similarity of Two Matrices</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for mantel.test {ape}"><tr><td>mantel.test {ape}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Mantel Test for Similarity of Two Matrices</h2>

<h3>Description</h3>

<p>This function computes Mantel's permutation test for similarity of two
matrices. It permutes the rows and columns of the second matrix
randomly and calculates a <i>Z</i>-statistic.
</p>


<h3>Usage</h3>

<pre>
mantel.test(m1, m2, nperm = 999, graph = FALSE,
            alternative = "two.sided",  ...)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>m1</code></td>
<td>
<p>a numeric matrix giving a measure of pairwise distances,
correlations, or similarities among observations.</p>
</td></tr>
<tr valign="top"><td><code>m2</code></td>
<td>
<p>a second numeric matrix giving another measure of pairwise
distances, correlations, or similarities among observations.</p>
</td></tr>
<tr valign="top"><td><code>nperm</code></td>
<td>
<p>the number of times to permute the data.</p>
</td></tr>
<tr valign="top"><td><code>graph</code></td>
<td>
<p>a logical indicating whether to produce a summary graph
(by default the graph is not plotted).</p>
</td></tr>
<tr valign="top"><td><code>alternative</code></td>
<td>
<p>a character string defining the alternative
hypothesis:  <code>"two.sided"</code> (default),  <code>"less"</code>,
<code>"greater"</code>, or any unambiguous abbreviation of these.</p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
<p>further arguments to be passed to <code>plot()</code> (to add a
title, change the axis labels, and so on).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function calculates a <i>Z</i>-statistic for the Mantel test, equal to
the sum of the  pairwise product of the lower triangles of the
permuted matrices, for each permutation of rows and columns. It
compares the permuted distribution with the <i>Z</i>-statistic observed
for the actual data.
</p>
<p>The present implementation can analyse symmetric as well as (since
version 5.1 of <span class="pkg">ape</span>) asymmetric matrices (see Mantel 1967,
Sects. 4 and 5). The diagonals of both matrices are ignored.
</p>
<p>If <code>graph = TRUE</code>, the functions plots the density estimate of
the permutation distribution along with the observed <i>Z</i>-statistic
as a vertical line.
</p>
<p>The <code>...</code> argument allows the user to give further options to
the <code>plot</code> function: the title main be changed with <code>main=</code>,
the axis labels with <code>xlab =</code>, and <code>ylab =</code>, and so on.
</p>


<h3>Value</h3>

<table summary="R valueblock">
<tr valign="top"><td><code>z.stat</code></td>
<td>
<p>the <i>Z</i>-statistic (sum of rows*columns of lower
triangle) of the data matrices.</p>
</td></tr>
<tr valign="top"><td><code>p</code></td>
<td>
<p><i>P</i>-value (quantile of the observed <i>Z</i>-statistic in
the permutation distribution).</p>
</td></tr>
<tr valign="top"><td><code>alternative</code></td>
<td>
<p>the alternative hypothesis.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Original code in S by Ben Bolker, ported to <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> by Julien Claude
</p>


<h3>References</h3>

<p>Mantel, N. (1967) The detection of disease clustering and a
generalized regression approach. <em>Cancer Research</em>, <b>27</b>,
209&ndash;220.
</p>
<p>Manly, B. F. J. (1986) <em>Multivariate statistical methods: a primer.</em>
London: Chapman &amp; Hall.
</p>


<h3>Examples</h3>

<pre>
q1 &lt;- matrix(runif(36), nrow = 6)
q2 &lt;- matrix(runif(36), nrow = 6)
diag(q1) &lt;- diag(q2) &lt;- 0
mantel.test(q1, q2, graph = TRUE,
            main = "Mantel test: a random example with 6 X 6 matrices
representing asymmetric relationships",
            xlab = "z-statistic", ylab = "Density",
            sub = "The vertical line shows the observed z-statistic")
</pre>

<hr /><div style="text-align: center;">[Package <em>ape</em> version 5.2 <a href="00Index.html">Index</a>]</div>
</body></html>
