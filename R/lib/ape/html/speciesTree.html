<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Species Tree Estimation</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for speciesTree {ape}"><tr><td>speciesTree {ape}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Species Tree Estimation</h2>

<h3>Description</h3>

<p>This function calculates the species tree from a set of gene trees.
</p>


<h3>Usage</h3>

<pre>
speciesTree(x, FUN = min)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>x</code></td>
<td>
<p>a list of trees, e.g., an object of class
<code>"multiPhylo"</code>.</p>
</td></tr>
<tr valign="top"><td><code>FUN</code></td>
<td>
<p>a function used to compute the divergence times of each
pair of tips.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For all trees in <code>x</code>, the divergence time of each pair of tips is
calculated: these are then &lsquo;summarized&rsquo; with <code>FUN</code> to build a new
distance matrix used to calculate the species tree with a
single-linkage hierarchical clustering. The default for <code>FUN</code>
computes the maximum tree (maxtree) of Liu et al. (2010). Using
<code>FUN = mean</code> gives the shallowest divergence tree of Maddison and
Knowles (2006).
</p>


<h3>Value</h3>

<p>an object of class <code>"phylo"</code>.
</p>


<h3>Author(s)</h3>

<p>Emmanuel Paradis</p>


<h3>References</h3>

<p>Liu, L., Yu, L. and Pearl, D. K. (2010) Maximum tree: a consistent
estimator of the species tree. <em>Journal of Mathematical Biology</em>,
<b>60</b>, 95&ndash;106.
</p>
<p>Maddison, W. P. and Knowles, L. L. (2006) Inferring phylogeny despite
incomplete lineage sorting. <em>Systematic Biology</em>, <b>55</b>, 21&ndash;30.
</p>


<h3>Examples</h3>

<pre>
### example in Liu et al. (2010):
tr1 &lt;- read.tree(text = "(((B:0.05,C:0.05):0.01,D:0.06):0.04,A:0.1);")
tr2 &lt;- read.tree(text = "(((A:0.07,C:0.07):0.02,D:0.09):0.03,B:0.12);")
TR &lt;- c(tr1, tr2)
TSmax &lt;- speciesTree(TR) # MAXTREE
TSsha &lt;- speciesTree(TR, mean) # shallowest divergence

kronoviz(c(tr1, tr2, TSmax, TSsha), horiz = FALSE,
         type = "c", cex = 1.5, font = 1)
mtext(c("Gene tree 1", "Gene tree 2", "Species tree - MAXTREE"),
      at = -c(7.5, 4, 1))
mtext("Species tree - Shallowest Divergence")
layout(1)
</pre>

<hr /><div style="text-align: center;">[Package <em>ape</em> version 5.2 <a href="00Index.html">Index</a>]</div>
</body></html>
