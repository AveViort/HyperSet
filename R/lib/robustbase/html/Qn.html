<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Robust Location-Free Scale Estimate More Efficient than MAD</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for Qn {robustbase}"><tr><td>Qn {robustbase}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Robust Location-Free Scale Estimate More Efficient than MAD</h2>

<h3>Description</h3>

<p>Compute the robust scale estimator <i>Qn</i>, an efficient
alternative to the MAD.
</p>
<p>See the references for more.
</p>


<h3>Usage</h3>

<pre>
Qn(x, constant = 2.21914, finite.corr = missing(constant))

s_Qn(x, mu.too = FALSE, ...)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>x</code></td>
<td>
<p>numeric vector of observations.</p>
</td></tr>
<tr valign="top"><td><code>constant</code></td>
<td>
<p>number by which the result is multiplied; the default
achieves consistency for normally distributed data.  Note that until
Nov. 2010, &ldquo;thanks&rdquo; to a typo in the very first papers, a slightly
wrong default constant, 2.2219, was used instead of the correct one
which is equal to <code>1 / (sqrt(2) * qnorm(5/8))</code> (as mentioned
already on p.1277, after (3.7) in Rousseeuw and Croux (1993)).
</p>
<p>If you need the old slightly off version for historical
reproducibility, you can use <code>Qn.old()</code>.
</p>
<p>Note that the relative difference is only about 1 in 1000, and that
the correction should not affect the finite sample corrections for
<i>n &lt;= 9</i>.
</p>
</td></tr>
<tr valign="top"><td><code>finite.corr</code></td>
<td>
<p>logical indicating if the finite sample bias
correction factor should be applied.  Defaults to <code>TRUE</code> unless
<code>constant</code> is specified.</p>
</td></tr>
<tr valign="top"><td><code>mu.too</code></td>
<td>
<p>logical indicating if the <code><a href="../../stats/html/median.html">median</a>(x)</code> should
also be returned for <code>s_Qn()</code>.</p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
<p>potentially further arguments for <code>s_Qn()</code> passed to
<code>Qn()</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>As the (default, consistency) constant needed to be corrected,
the finite sample correction has been based on a much more extensive
simulation, and on a 3rd or 4th degree polynomial model in <i>1/n</i>
for odd or even n, respectively.
</p>


<h3>Value</h3>

<p><code>Qn()</code> returns a number, the <i>Qn</i> robust scale
estimator, scaled to be consistent for <i>&sigma;^2</i> and
i.i.d. Gaussian observatsions, optionally bias corrected for finite
samples.
</p>
<p><code>s_Qn(x, mu.too=TRUE)</code> returns a length-2 vector with location
(<i>&mu;</i>) and scale; this is typically only useful for
<code><a href="covOGK.html">covOGK</a>(*, sigmamu = s_Qn)</code>.
</p>


<h3>Author(s)</h3>

<p>Original Fortran code:
Christophe Croux and Peter Rousseeuw <a href="mailto:rousse@wins.uia.ac.be">rousse@wins.uia.ac.be</a>.
<br />
Port to C and R: Martin Maechler, <a href="mailto:maechler@R-project.org">maechler@R-project.org</a>
</p>


<h3>References</h3>

<p>Rousseeuw, P.J. and Croux, C. (1993)
Alternatives to the Median Absolute Deviation,
<em>Journal of the American Statistical Association</em> <b>88</b>, 1273&ndash;1283.

</p>
<p>Christophe Croux and Peter J. Rousseeuw (1992)
Time-Efficient Algorithms for Two Highly Robust Estimators of Scale,
<em>Computational Statistics, Vol. 1</em>, ed. Dodge and Whittaker,
Physica-Verlag Heidelberg, 411&ndash;428; available via Springer Link.


</p>
<p>About the typo in the <code>constant</code>:<br />
Christophe Croux (2010)
Private e-mail, Fri Jul 16, w/ Subject
<em>Re: Slight inaccuracy of Qn implementation ......</em>.
</p>


<h3>See Also</h3>

<p><code><a href="../../stats/html/mad.html">mad</a></code> for the &lsquo;most robust&rsquo; but much less efficient
scale estimator; <code><a href="Sn.html">Sn</a></code> for a similar faster but less
efficient alternative.  Finally, <code><a href="scaleTau2.html">scaleTau2</a></code> which some
consider &ldquo;uniformly&rdquo; better than Qn or competitors.
</p>


<h3>Examples</h3>

<pre>
set.seed(153)
x &lt;- sort(c(rnorm(80), rt(20, df = 1)))
s_Qn(x, mu.too = TRUE)
Qn(x, finite.corr = FALSE)
</pre>

<hr /><div style="text-align: center;">[Package <em>robustbase</em> version 0.93-3 <a href="00Index.html">Index</a>]</div>
</body></html>
