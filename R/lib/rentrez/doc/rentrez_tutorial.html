<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title>Introduction: The NCBI, entrez and <code>rentrez</code>.</title>

<script type="text/javascript">
window.onload = function() {
  var imgs = document.getElementsByTagName('img'), i, img;
  for (i = 0; i < imgs.length; i++) {
    img = imgs[i];
    // center an image if it is the only element of its parent
    if (img.parentElement.childElementCount === 1)
      img.parentElement.style.textAlign = 'center';
  }
};
</script>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: #990073
   }

   pre .number {
     color: #099;
   }

   pre .comment {
     color: #998;
     font-style: italic
   }

   pre .keyword {
     color: #900;
     font-weight: bold
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: #d14;
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>



<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 13px;
}

body {
  max-width: 800px;
  margin: auto;
  padding: 1em;
  line-height: 20px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 {
   font-size:2.2em;
}

h2 {
   font-size:1.8em;
}

h3 {
   font-size:1.4em;
}

h4 {
   font-size:1.0em;
}

h5 {
   font-size:0.9em;
}

h6 {
   font-size:0.8em;
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre, img {
  max-width: 100%;
}
pre {
  overflow-x: auto;
}
pre code {
   display: block; padding: 0.5em;
}

code {
  font-size: 92%;
  border: 1px solid #ccc;
}

code[class] {
  background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * {
      background: transparent !important;
      color: black !important;
      filter:none !important;
      -ms-filter: none !important;
   }

   body {
      font-size:12pt;
      max-width:100%;
   }

   a, a:visited {
      text-decoration: underline;
   }

   hr {
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote {
      padding-right: 1em;
      page-break-inside: avoid;
   }

   tr, img {
      page-break-inside: avoid;
   }

   img {
      max-width: 100% !important;
   }

   @page :left {
      margin: 15mm 20mm 15mm 10mm;
   }

   @page :right {
      margin: 15mm 10mm 15mm 20mm;
   }

   p, h2, h3 {
      orphans: 3; widows: 3;
   }

   h2, h3 {
      page-break-after: avoid;
   }
}
</style>



</head>

<body>
<h2>Introduction: The NCBI, entrez and <code>rentrez</code>.</h2>

<p>The NCBI shares a <em>lot</em> of data. At the time this document was compiled, there
were 28.2 million papers in <a href="http://www.ncbi.nlm.nih.gov/pubmed/">PubMed</a>,
including 4.9 million full-text records available in <a href="http://www.ncbi.nlm.nih.gov/pubmed/">PubMed Central</a>.
<a href="http://www.ncbi.nlm.nih.gov/nuccore">The NCBI Nucleotide Database</a> (which includes GenBank) has data for 256.7
million different sequences, and <a href="http://www.ncbi.nlm.nih.gov/snp/">dbSNP</a> describes
1070.2 million different genetic variants. All of these
records can be cross-referenced with the  1.33 million
species in the <a href="www.ncbi.nlm.nih.gov/taxonomy">NCBI taxonomy</a> or 25.7 thousand disease-associated records
in <a href="http://www.ncbi.nlm.nih.gov/omim">OMIM</a>.</p>

<p>The NCBI makes this data available through a <a href="http://www.ncbi.nlm.nih.gov/">web interface</a>,
an <a href="ftp://ftp.ncbi.nlm.nih.gov/">FTP server</a> and through a REST API called the
<a href="http://www.ncbi.nlm.nih.gov/books/NBK25500/">Entrez Utilities</a> (<code>Eutils</code> for
short). This package provides functions to use that API, allowing users to
gather and combine data from multiple NCBI databases in the comfort of an R
session or script.</p>

<h2>Getting started with the rentrez</h2>

<p>To make the most of all the data the NCBI shares you need to know a little about
their databases, the records they contain and the ways you can find those
records. The <a href="http://www.ncbi.nlm.nih.gov/home/documentation.shtml">NCBI provides extensive documentation for each of their
databases</a> and for the
<a href="http://www.ncbi.nlm.nih.gov/books/NBK25501/">EUtils API that <code>rentrez</code> takes advantage of</a>.
There are also some helper functions in <code>rentrez</code> that help users learn their
way around the NCBI&#39;s databases. </p>

<p>First, you can use <code>entrez_dbs()</code> to find the list of available databases:</p>

<pre><code class="r">entrez_dbs()
</code></pre>

<pre><code>##  [1] &quot;pubmed&quot;          &quot;protein&quot;         &quot;nuccore&quot;        
##  [4] &quot;ipg&quot;             &quot;nucleotide&quot;      &quot;nucgss&quot;         
##  [7] &quot;nucest&quot;          &quot;structure&quot;       &quot;sparcle&quot;        
## [10] &quot;genome&quot;          &quot;annotinfo&quot;       &quot;assembly&quot;       
## [13] &quot;bioproject&quot;      &quot;biosample&quot;       &quot;blastdbinfo&quot;    
## [16] &quot;books&quot;           &quot;cdd&quot;             &quot;clinvar&quot;        
## [19] &quot;clone&quot;           &quot;gap&quot;             &quot;gapplus&quot;        
## [22] &quot;grasp&quot;           &quot;dbvar&quot;           &quot;gene&quot;           
## [25] &quot;gds&quot;             &quot;geoprofiles&quot;     &quot;homologene&quot;     
## [28] &quot;medgen&quot;          &quot;mesh&quot;            &quot;ncbisearch&quot;     
## [31] &quot;nlmcatalog&quot;      &quot;omim&quot;            &quot;orgtrack&quot;       
## [34] &quot;pmc&quot;             &quot;popset&quot;          &quot;probe&quot;          
## [37] &quot;proteinclusters&quot; &quot;pcassay&quot;         &quot;biosystems&quot;     
## [40] &quot;pccompound&quot;      &quot;pcsubstance&quot;     &quot;pubmedhealth&quot;   
## [43] &quot;seqannot&quot;        &quot;snp&quot;             &quot;sra&quot;            
## [46] &quot;taxonomy&quot;        &quot;biocollections&quot;  &quot;unigene&quot;        
## [49] &quot;gencoll&quot;         &quot;gtr&quot;
</code></pre>

<p>There is a set of functions with names starting <code>entrez_db_</code> that can be used to
gather more information about each of these databases:</p>

<p><strong>Functions that help you learn about NCBI databases</strong></p>

<table><thead>
<tr>
<th>Function name</th>
<th>Return</th>
</tr>
</thead><tbody>
<tr>
<td><code>entrez_db_summary()</code></td>
<td>Brief description of what the database is</td>
</tr>
<tr>
<td><code>entrez_db_searchable()</code></td>
<td>Set of search terms that can used with this database</td>
</tr>
<tr>
<td><code>entrez_db_links()</code></td>
<td>Set of databases that might contain linked records</td>
</tr>
</tbody></table>

<p>For instance, we can get a description of the somewhat cryptically named
database &#39;cdd&#39;&hellip;</p>

<pre><code class="r">entrez_db_summary(&quot;cdd&quot;)
</code></pre>

<pre><code>##  DbName: cdd
##  MenuName: Conserved Domains
##  Description: Conserved Domain Database
##  DbBuild: Build170330-1240.1
##  Count: 56066
##  LastUpdate: 2017/03/31 15:56
</code></pre>

<p>&hellip; or find out which search terms can be used with the Sequence Read Archive (SRA)
database (which contains raw data from sequencing projects):</p>

<pre><code class="r">entrez_db_searchable(&quot;sra&quot;)
</code></pre>

<pre><code>## Searchable fields for database &#39;sra&#39;
##   ALL     All terms from all searchable fields 
##   UID     Unique number assigned to publication 
##   FILT    Limits the records 
##   ACCN    Accession number of sequence 
##   TITL    Words in definition line 
##   PROP    Classification by source qualifiers and molecule type 
##   WORD    Free text associated with record 
##   ORGN    Scientific and common names of organism, and all higher levels of taxonomy 
##   AUTH    Author(s) of publication 
##   PDAT    Date sequence added to GenBank 
##   MDAT    Date of last update 
##   GPRJ    BioProject 
##   BSPL    BioSample 
##   PLAT    Platform 
##   STRA    Strategy 
##   SRC     Source 
##   SEL     Selection 
##   LAY     Layout 
##   RLEN    Percent of aligned reads 
##   ACS     Access is public or controlled 
##   ALN     Percent of aligned reads 
##   MBS     Size in megabases
</code></pre>

<p>Just how these &#39;helper&#39; functions might be useful will become clearer once
you&#39;ve started using <code>rentrez</code>, so let&#39;s get started.</p>

<h2>Searching databases: <code>entrez_search()</code></h2>

<p>Very often, the first thing you&#39;ll want to do with <code>rentrez</code> is search a given
NCBI database to find records that match some keywords. You can do this using
the function <code>entrez_search()</code>. In the simplest case you just need to provide a 
database name (<code>db</code>) and a search term (<code>term</code>) so let&#39;s search PubMed for
articles about the <code>R language</code>:</p>

<pre><code class="r">r_search &lt;- entrez_search(db=&quot;pubmed&quot;, term=&quot;R Language&quot;)
</code></pre>

<p>The object returned by a search acts like a list, and you can get a summary of 
its contents by printing it.</p>

<pre><code class="r">r_search
</code></pre>

<pre><code>## Entrez search result with 10792 hits (object contains 20 IDs and no web_history object)
##  Search term (as translated):  R[All Fields] AND (&quot;programming languages&quot;[MeSH Te ...
</code></pre>

<p>There are a few things to note here. First, the NCBI&#39;s server has worked out
that we meant R as a programming language, and so included the
<a href="http://www.ncbi.nlm.nih.gov/mesh">&#39;MeSH&#39; term</a> term associated with programming
languages. We&#39;ll worry about MeSH terms and other special queries later, for now
just note that you can use this feature to check that your search term was interpreted in the way
you intended. Second, there are many more &#39;hits&#39; for this search than there
are unique IDs contained in this object. That&#39;s because the optional argument
<code>retmax</code>, which controls the maximum number of returned values has a default
value of 20.</p>

<p>The IDs are the most important thing returned here. They
allow us to fetch records matching those IDs, gather summary data about them or find
cross-referenced records in other databases. We access the IDs as a vector using the
<code>$</code> operator:</p>

<pre><code class="r">r_search$ids
</code></pre>

<pre><code>##  [1] &quot;29500728&quot; &quot;29500026&quot; &quot;29499366&quot; &quot;29496601&quot; &quot;29496195&quot; &quot;29490518&quot;
##  [7] &quot;29490021&quot; &quot;29489693&quot; &quot;29489446&quot; &quot;29488835&quot; &quot;29483354&quot; &quot;29483353&quot;
## [13] &quot;29481342&quot; &quot;29476512&quot; &quot;29472165&quot; &quot;29472110&quot; &quot;29470175&quot; &quot;29466552&quot;
## [19] &quot;29462238&quot; &quot;29459980&quot;
</code></pre>

<p>If we want to get more than 20 IDs we can do so by increasing the <code>ret_max</code> argument.</p>

<pre><code class="r">another_r_search &lt;- entrez_search(db=&quot;pubmed&quot;, term=&quot;R Language&quot;, retmax=40)
another_r_search
</code></pre>

<pre><code>## Entrez search result with 10792 hits (object contains 40 IDs and no web_history object)
##  Search term (as translated):  R[All Fields] AND (&quot;programming languages&quot;[MeSH Te ...
</code></pre>

<p>If we want to get IDs for all of the thousands of records that match this
search, we can use the NCBI&#39;s web history feature <a href="#web_history">described below</a>.</p>

<h3>Building search terms</h3>

<p>The EUtils API uses a special syntax to build search terms. You can search a
database against a specific term using the format <code>query[SEARCH FIELD]</code>, and
combine multiple such searches using the boolean operators <code>AND</code>, <code>OR</code> and <code>NOT</code>.</p>

<p>For instance, we can find next generation sequence datasets for the (amazing&hellip;) ciliate
<em>Tetrahymena thermophila</em> by using the organism (&#39;ORGN&#39;) search field:</p>

<pre><code class="r">entrez_search(db=&quot;sra&quot;,
              term=&quot;Tetrahymena thermophila[ORGN]&quot;,
              retmax=0)
</code></pre>

<pre><code>## Entrez search result with 282 hits (object contains 0 IDs and no web_history object)
##  Search term (as translated):  &quot;Tetrahymena thermophila&quot;[Organism]
</code></pre>

<p>We can narrow our focus to only those records that have been added recently (using the colon to 
specify a range of values):</p>

<pre><code class="r">entrez_search(db=&quot;sra&quot;,
              term=&quot;Tetrahymena thermophila[ORGN] AND 2013:2015[PDAT]&quot;,
              retmax=0)
</code></pre>

<pre><code>## Entrez search result with 75 hits (object contains 0 IDs and no web_history object)
##  Search term (as translated):  &quot;Tetrahymena thermophila&quot;[Organism] AND 2013[PDAT] ...
</code></pre>

<p>Or include recent records for either <em>T. thermophila</em> or it&#39;s close relative <em>T.
borealis</em> (using parentheses to make ANDs and ORs explicit).</p>

<pre><code class="r">entrez_search(db=&quot;sra&quot;,
              term=&quot;(Tetrahymena thermophila[ORGN] OR Tetrahymena borealis[ORGN]) AND 2013:2015[PDAT]&quot;,
              retmax=0)
</code></pre>

<pre><code>## Entrez search result with 75 hits (object contains 0 IDs and no web_history object)
##  Search term (as translated):  (&quot;Tetrahymena thermophila&quot;[Organism] OR &quot;Tetrahyme ...
</code></pre>

<p>The set of search terms available varies between databases. You can get a list
of available terms or any given data base with <code>entrez_db_searchable()</code></p>

<pre><code class="r">entrez_db_searchable(&quot;sra&quot;)
</code></pre>

<pre><code>## Searchable fields for database &#39;sra&#39;
##   ALL     All terms from all searchable fields 
##   UID     Unique number assigned to publication 
##   FILT    Limits the records 
##   ACCN    Accession number of sequence 
##   TITL    Words in definition line 
##   PROP    Classification by source qualifiers and molecule type 
##   WORD    Free text associated with record 
##   ORGN    Scientific and common names of organism, and all higher levels of taxonomy 
##   AUTH    Author(s) of publication 
##   PDAT    Date sequence added to GenBank 
##   MDAT    Date of last update 
##   GPRJ    BioProject 
##   BSPL    BioSample 
##   PLAT    Platform 
##   STRA    Strategy 
##   SRC     Source 
##   SEL     Selection 
##   LAY     Layout 
##   RLEN    Percent of aligned reads 
##   ACS     Access is public or controlled 
##   ALN     Percent of aligned reads 
##   MBS     Size in megabases
</code></pre>

<h3>Using the Filter field</h3>

<p>&ldquo;Filter&rdquo; is a special field that, as the names suggests, allows you to limit 
records returned by a search to set of filtering criteria. There is no programmatic 
way to find the particular terms that can be used with the Filter field. 
However, the NCBI&#39;s website provides an &ldquo;advanced search&rdquo; tool for some 
databases that can be used to discover these terms. </p>

<p>For example, to find the list of possible to find all of the terms that can be
used to filter searches to the nucleotide database using the 
<a href="https://www.ncbi.nlm.nih.gov/nuccore/advanced">advanced search for that databse</a>.
On that page selecting &ldquo;Filter&rdquo; from the first drop-down box then clicking 
&ldquo;Show index list&rdquo; will allow the user to scroll through possible filtering
terms.</p>

<p>###Precise queries using MeSH terms</p>

<p>In addition to the search terms described above, the NCBI allows searches using
<a href="http://www.ncbi.nlm.nih.gov/mesh">Medical Subject Heading (MeSH)</a> terms. These
terms create a &#39;controlled vocabulary&#39;,  and allow users to make very finely
controlled queries of databases.</p>

<p>For instance, if you were interested in reviewing studies on how a class of
anti-malarial drugs called Folic Acid Antagonists work against <em>Plasmodium vivax</em> (a
particular species of malarial parasite), you could use this search:</p>

<pre><code class="r">entrez_search(db   = &quot;pubmed&quot;,
              term = &quot;(vivax malaria[MeSH]) AND (folic acid antagonists[MeSH])&quot;)
</code></pre>

<pre><code>## Entrez search result with 14 hits (object contains 14 IDs and no web_history object)
##  Search term (as translated):  &quot;malaria, vivax&quot;[MeSH Terms] AND &quot;folic acid antag ...
</code></pre>

<p>The complete set of MeSH terms is available as a database from the NCBI. That
means it is possible to download detailed information about each term and find 
the ways in which terms relate to each other using <code>rentrez</code>. You can search 
for specific terms with <code>entrez_search(db=&quot;mesh&quot;, term =...)</code> and learn about the
results of your search using the tools described below.</p>

<h3>Advanced counting</h3>

<p>As you can see above, the  object returned by <code>entrez_search()</code> includes the
number of records matching a given search. This means you can learn a little
about the composition of, or trends in, the records stored in the NCBI&#39;s
databases using only the search utility. For instance, let&#39;s track the rise of
the scientific buzzword &ldquo;connectome&rdquo; in PubMed, programmatically creating 
search terms for the <code>PDAT</code> field:</p>

<pre><code class="r">search_year &lt;- function(year, term){
    query &lt;- paste(term, &quot;AND (&quot;, year, &quot;[PDAT])&quot;)
    entrez_search(db=&quot;pubmed&quot;, term=query, retmax=0)$count
}

year &lt;- 2008:2014
papers &lt;- sapply(year, search_year, term=&quot;Connectome&quot;, USE.NAMES=FALSE)

plot(year, papers, type=&#39;b&#39;, main=&quot;The Rise of the Connectome&quot;)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAWgAAAEgCAMAAACuMBnmAAAC+lBMVEUAAAABAQECAgIDAwMEBAQFBQUGBgYHBwcICAgJCQkKCgoLCwsMDAwNDQ0ODg4PDw8QEBARERESEhITExMUFBQVFRUWFhYXFxcYGBgZGRkaGhobGxscHBwdHR0eHh4fHx8gICAhISEiIiIjIyMkJCQlJSUmJiYnJycoKCgpKSkqKiorKyssLCwtLS0uLi4vLy8wMDAxMTEyMjIzMzM0NDQ1NTU2NjY3Nzc4ODg5OTk6Ojo7Ozs8PDw9PT0+Pj4/Pz9AQEBBQUFCQkJDQ0NERERFRUVGRkZHR0dISEhJSUlKSkpLS0tMTExNTU1OTk5PT09QUFBRUVFSUlJTU1NUVFRVVVVWVlZXV1dYWFhZWVlaWlpbW1tcXFxdXV1eXl5fX19gYGBhYWFiYmJjY2NkZGRlZWVmZmZnZ2doaGhpaWlqampra2tsbGxtbW1ubm5vb29wcHBxcXFycnJzc3N0dHR1dXV3d3d4eHh5eXl6enp7e3t8fHx9fX1+fn5/f3+AgICBgYGCgoKDg4OFhYWGhoaHh4eIiIiJiYmKioqLi4uMjIyNjY2Ojo6Pj4+QkJCRkZGSkpKTk5OUlJSVlZWWlpaXl5eYmJiZmZmampqbm5ucnJydnZ2enp6fn5+goKChoaGioqKjo6OkpKSlpaWmpqanp6eoqKipqamqqqqrq6usrKytra2urq6vr6+wsLCxsbGysrKzs7O0tLS1tbW2tra3t7e4uLi5ubm6urq7u7u8vLy9vb2+vr6/v7/AwMDBwcHCwsLDw8PExMTFxcXGxsbHx8fIyMjJycnKysrLy8vMzMzNzc3Ozs7Pz8/Q0NDR0dHS0tLT09PU1NTV1dXW1tbX19fY2NjZ2dna2trb29vc3Nzd3d3e3t7f39/g4ODh4eHi4uLj4+Pk5OTl5eXm5ubn5+fo6Ojp6enq6urr6+vs7Ozt7e3u7u7v7+/w8PDx8fHy8vLz8/P09PT19fX29vb39/f4+Pj5+fn6+vr7+/v8/Pz9/f3+/v7///+Iq34+AAAACXBIWXMAAAsSAAALEgHS3X78AAAR00lEQVR4nO2deXwTVR7AH0cVSoUuFBAEdbUIYgtFQHrRtDVcS1kuCy1gFamtrtBVZMuia72gsOpSj+USBY8VK1DQdQWryFG5BZRwtyhWamlpy1FoSo73+exkcrRJZjJvMjMvzeT3/WOu93u/efkyTF4nM28QBqiAfN2AQAFEUwJEUwJEUwJEUwJEUwJEUwJEUwJEUwJEUwJEUwJEUwJEUwJEUwJEUwJEUwJEUwJEUwJEUwJEUwJEUwJEUwJEU0Jx0VHISmY9asdRHG4pa3XXW9iIhJqyv0/b5Y4V7my45snI4Hvn10lor1IoLnpqVFRn1C0q6iU+0X+MGtgGoZ3CotORpoRdiEIHeUSf7YVa9QpCA66JaaElnfLQOHU8iuZjvmMwHG3C+GAYeh7r9QJpRqMi6wK/6CloSDmuuBctFtM8FYreMqDjlMsYn0np0nvWJWsZKxpPRgtZc7sTbun65+POEVefDg+5f431HPSiZYNlYT1ntiqEjjCzzdFzHbWqw4cWRXQcX9W04Khw8dHenUYcsaZzxJ8LT/7XbXcU7BkckvSLczskQlN06/bMSWIBrgsLGh+Hoq1lrOjzf0QlFtEXO7WeqEG99E4Ryej2lGBUgLcMRM/qLBu23IFeLefMVoJ62Pdpr1WJ2t4c1RZlNS3YK5iHoMi4Vt2q2XSO+FLUqv19CN3U9xY0xbmlEqEpGv0Xv46S8RI0G+No9DVbxn4ZojZ57LlgG7rnAp4/45fmETvQ7VeZSRfLqWOTNZ/11MGRbR2Ksu3SUasSoe34QzSgacFeYSu614hT0XtsOkd8KUJncDyagYtRP+eWSoSm6JvMeCdzfDxq7Ya8xpZZvgwH3ITSzRbR1aGodczLF5wi3kJPMdMeqMJVNEe2Xai3bZeOWpUoFOMTKBw7FuwVlqJMjI16A5vOEV9qSZGGVuOTzULlkED5y7CEUTMLPbmO4QhbZj11tEFVbHHN8/0QCj3TPOIty1GFb0O/uormyHYBtTrNzLYMyXTUqkRhmJXmWLBXeA0925TOEV+K7rSIXuMUKocEH4h+DT2D8bY1Z9gy65dhL6SzFH8++zN8Kga91TziO3RnPXOodnY6dezjyTYJJV3CtbFonqOWu2h7hS/QQCPOjdrIpnPEO4l2yi0RH4iu7Rw0c3qbLlVsmV30N5bir1Hw1PQQtNMpQoPumhiC3mwmOhZNO82drbQHCronGN1x0VHLXbS9gjECDUxq1bWSTeeIdxLtlFsiPhCNj40M7TLhhLXMKlqDZrPF/xnaqUPUB84RV3Lu7jCI6Xg1iV7XrU0RdzZcndk/uG9OZVMtd9GOCr9P69lp9FFrOke8k2jn3NKAax2UANGUANGUANGUANGUANGUANGUANGUANGUANGUANGUANGUANGUANGUANGUANGUANGUIBJtvmJWuh2qR1i0/oU+QahteF4jhdaoGGHRGRNKag21e9JmUmiNihEWHdbAzoy3K90UdSMseqD1t+ftg5RuiroRFr2/R+TUzLRBPQ9QaI2KIeh1GIpXLl5ZbHDbXl0INGP9Dami+bp3n05bATQRVypRNG/37tN3SP6RAoZZUkXzdu9ANMaXSxx3QEoW7d69+yqLJXqGt81TDesTFmRMsvqRLtq9e1dfxjIz1fsWqoPqROYL8OOXrCuSRfN2756e6l3z1MPWhcykcaR1RbJo3u4diD4wl5lU2v5jSxdtoabefRuINiRvx5cmb7WuSBad0oBPD24dNOp31wIQjaue0oz50rYsWTSqx8m5DY0vTnYtANFOyCE6lDlBm7q5FgS46N0Lndeliy7D9zM5jvV0LQhs0ZsSXZ4hkiw6oVdI6Ci8LcztscaAFr1qsusICjL0OvQn9uLvv3XbHMCizXmz3Lq78nTvuAhc0Y0z8tw3gmjZuTLuI46tIFpuzsd/xbUZRMuMbtghzu0gWl62xZ7jLgDRsrJ+DN8QZCBaTpamNvAVgWj5MM7OMfEWgmjZ0Kct8VAKouWiRrvOUzGIlomzMTs9loNoefgxTmAkGhAtC8VxvwlEgGg5eH/MZaEQEC0D+Y94voPRAoiWjDE7l+AZHhAtlfo/LyMJA9ESqUz4gihOAdFnrXdejx3vRV2/ozR6N1mgAqL357PEj/Wirr+xN/o0YSScOqRQ5HpTAT8gWgLuNxXwA6K9xpyX6X4PLS8g2mtm5IuJBtFes09UNIgWz7VtJeKHGADRotkfm7cgjrRX5wBEiyaB6dKVpYitBaLFUjfBMk0SOxYMiBaLMYmZmBPEVgPRonlmceO1eZ5+8OYERIvGUDBy9PuiR5EC0ZQA0ZQA0SJ5t9y7eiBaHIdH899e5xEQLQp9PM/tz4KAaFHM/dDbmnKI5h5TSY2id7o9iE2MZNG8YyqpUPSloRe8rqvcmEoqFP3If72vq8CYSjbUJ3rTExIqKzCmkg3Via6KuSKhNoypRMx4z3eaCwBjKpGy8jlJ1QlFn8I3NrzHd29qQHTvziZIG4qcTPQ/go35/YdlcUUESPfONPInaQnIRHc5i3vtrXMbzcdCgHTvFr0hMQGZ6M61B3uYroZyRbh37z4dzNL9QYlNa0notF5eS3JAJjpr4N1LqqI5f/kNiO6dfvgvUlOQiTZ+9omhIp/zgZiA6N7NWys5BZHoin4cIzXaCYDuXckk6TnIjui0fIEfIzluq1SP6KsxldKTkInW3BzWPyIigiviQvbwBRVRbWLPuhaoR/RjZE+peIZMtM4KV8TYlMKMnivrFv7JtUA1ojc/LkcW0j/BzRd5IkJrsK7DDRUPmSntWpIDMtHlySERJ+Pdzg4Wep/Bxo1Mc1Q7ZGbqdlnSkIlOnd8YYVqo5YpYHjyCma6NeN61QCWiV8+XJw+Z6O4GHIENnTlDTn7ATJYXuW1Xh+ifY3hHSRIHmejIEkb0of6iMqtCtGnUjzJlIhP9bVh62Mywz0VlVoXoJf+UKxNhr6Nq9YvLfhWXWQ2ij2mNcqUiFG06s6tMZGYViG6MOyMcRAjhHyz3dR/YOeqkqMwqEJ37nny5yETHfoyx4ZVYUZn9X/T3E2VMRijaMjGGicrs96Lr5biW5IBM9MOWq82bxonK7PeiM9fLmY1MdGbbuIceQKNmiHmhm7+L3jJL1nRkotfZEZHZz0VXRwuOsCYKMTfQbBSV2c9FT/1O3nxkok9mp6WlpYh7I7V/i17zN5kTkokemv2MZq1mg6jMfi26PE6ma0kOyER30F8fgn8dJiqzP4s2jT4id0oy0T2O4vt/M3UXldmfRb8uanAZIshEL21X8VLkyERRmf1Y9PEHZbuW5ICw13FebyosqBWV2X9FGxJFD3siDFy9c2fBKgWSKnD17otUlj6cPzH6AbvHih66gAAFrt5dt70XfIrEpvmI+li31+fKAVy9cyW7UJG0cPXOha2PKpMXrt45c3GouL4VMXD1zpm0bQolhtENnGhYoVRmEE0JEE0JEG1nVVLibIW+CC2AaBur5jTirQq+lgBE29BaHsDOkPyUGy8g2gZ7DThHrntH3QHRNuZ8hfGlGOF3XnkLiLZxJWX6nNhdyuUH0Q5+/lG54xlEs1zJU34fIBrjstjNyu8EROMdsccp7AVErxhXR2M3gT5kpv6xHPlvLeAiwIfMrBolfSQOMgJ7yMxDMftp7Sqgh8z8RKvID96cBPCQmcbcx6UNZSeKwB0y8/JE+e9k9EDADpl5Ov4bqvsL1O7d/4Zzjj6iHIHZvTPnj5f3USBhFOjelbb494I3ZORKHZhRNAp0735o6e8FL08S9zSOLARg964k9qgP9hp43bsVWuKXpstJoHXvDLlZSv6Owk+AXSa9OGa1j/YcWKJ/jN3jq11LFn3SjmtBCxRd6PUrxaQjWfQo1P5WFteCFifanD/tuu/2Lv3Ukc3zvp2WJvrqQ1QvIrkiXfT2xdzbW5jo0hhxw/bJTaB8GW6PO+HbBgSI6F0TaV9EciVARPsetYveOTYp3fNHpITKRR8ZcQEfj6Nyh4wAKhc9bx8z+beYxyOVQuWiMy2juK5b5utmYLWKbjj4bs6I15mFj15m/iKcdMx3LXGgOtG1u5Y+/GByzopd7J/b5tnjc5NawgGtJtE3dGtzJ8Sk5H1e1vxH+Yo9lyi3gxs/FV2353zzVcthnPxg1tJd1xTcpzT8U/SKpNyJT7LHrUFXmDchNiWvUKfE+Dwy4peiT4xnrC5cwyy9qZ2z6oAPL36S45eiV3/ITH55RLH8StCyRP/O/1qqqqNb1i7KSU18mlneuJSZ/PCM103zBRREGw8f0BPV+CkhbfR05/NAra54bX5OarJWk5KVt7RwVxn7a/vluKO4atRh79vmA5S/yfGcZs68OBIppjimJ1E4j1nS79387xcyU4ZrEqf+dfHar3Vub54rm56UIum98/RR/ibHSTrmlKBxr2iora0pKys7dPDgd8XF3zIbTrHvHbc8/H702Tc+3nFClrfbtRiUf4aFHTZgMnNQXh+jfUCrjU7Wxmm0CcO12rGpqelZWU/k5uYuyi9gYs5lMBNTkvjP4BcocJPjei3L3bY34mos5xUtyUMMI/Zi8yuyvZyqhaHcTY6fvmOdL3zeYF6eTdKWiumahFep309LCeVucrSLNr2TnPQqWbdDzSh3k6NdNMCiXD8aRDuhnOgtA7U2IkM6E9KhE2lkO9JA8sjQDqSRt3QkjQwebpfQ97xHWxJEN7HpDdLI+cQ3e5K/b4A48oe5pJFvE498PKOcMBBEcwGiJUWCaC5ANAcgWhgQzUVLFf1FAWnkgn2kkeTvHiGOPDyPNHIZ8QOhGZ47dU3IItpA/KNePfEvrOTXUIkjzVdJIxuIn6Aj3rksogFhQDQlQDQlQDQlQDQlQDQlQDQlQDQlvBa9vk9o0gmMDwzq+ojeMSvq02ncBaLIT/p0y3B7YbRzJMYPWB70d6wJBTpmgpG2jQSRy28PHec2zArP3nUdPejyWvTvHb83Lb4PG3oUXR//gn12sf3muoceI4k8GvZTw/Rcj5F4x+OI+QT2NcFA+0w40raRIPJU8OmaFNdH4bn3jo1D23kS5q3oomSMb7SuK47EuOQebJvtu5X55x5KErkkE+NS19FOnSPx4ifaM5/AviYYaJ8JR9o2EkR+MALjwuEkOTFeNE0R0fU1GG+7C6+cinFtkNk2q+/2Ufm4v5FEvsqI/rm10VMks+FW5hM0rQkENs2EIm0bCSKZ4/RYxgKiyOP3lSkimmFT9w14MSPMgK7YZvht1K5rNUnk/i4Ha9OR+5urmkXaPkHTmkAg5hLNF2nZSBS5sUNPjgF73SNNMTsqlRFd+1C/EuZ4S2OW2pptsx39TzauiCKJxO/17/vPINdLeU6Rtk/QtCYQiDlFc0ZaN5JEYty40vMHskW+PhsrI/rGA3+xXEosHoTxnnD7LO9pjM1B1QSR9ZUY74/wmNP2CZrWBAIxl2jOSNtGgsjlH2B8qY2BIHJGSEgwCtnNL8xb0Z8N1jNgQ8/txvQ8++zL8CPX3rybJFLX6dS1sa4/FzhH2j5B05pAIOYSzRlp20gQuTGy2rzI9SXefHtX5oiejyxcwgeierO9Y+us4M7QRNdRFLkj3+5+x99dzxwukbZP4FgTCuQSzRlp30iQ87me3ca4jtrLt3eFztGAOEA0JUA0JUA0JUA0JUA0JUA0JUA0JUA0JUA0JUA0JUA0JUA0JUA0JUA0JUA0JUA0JUA0JUA0JUA0JUA0JdQlusLXDeDHT0XP/BfGz83F2wZ0n/IbxgW3hQw7hXWa9H6+bhc/fip6wwiMI0qqw3YacpPx+XY/NWRlY93Ni4if2KSPn4q+ckt96a2m1ekYN4aY9RX4+tw0rAtryQMf+6lorN382hP4xbAIhoumlwcP0TCi+/u6UZ7wV9FLs+OL8bKZGJtO4sLIcryWEe1602SLwl9Fl3YNM+BzYYcNC+NxwSjTr4kpIFoZ+lqG8d7c7w/JZ3GNpvuwDYM2gmhFiN/s6xaIw09FGw51cXt4rmXjp6KLehIPxtNC8FPR/geIpgSIpgSIpgSIpgSIpgSIpgSIpgSIpgSIpgSIpgSIpgSIpgSIpgSIpgSIpsT/AdVHr+S7hR2NAAAAAElFTkSuQmCC" title="plot of chunk connectome" alt="plot of chunk connectome" style="display: block; margin: auto;" /></p>

<h2>Finding cross-references : <code>entrez_link()</code>:</h2>

<p>One of the strengths of the NCBI databases is the degree to which records of one
type are connected to  other records within the NCBI or to external data
sources. The function <code>entrez_link()</code> allows users to discover these links
between records.</p>

<p>###My god, it&#39;s full of links</p>

<p>To get an idea of the degree to which records in the NCBI are cross-linked we
can find all NCBI data associated with a single gene (in this case the 
Amyloid Beta Precursor gene, the product of which is associated with the 
plaques that form in the brains of  Alzheimer&#39;s Disease patients).</p>

<p>The function <code>entrez_link()</code> can be used to find cross-referenced records. In
the most basic case we need to provide an ID (<code>id</code>), the database from which this
ID comes (<code>dbfrom</code>) and the name of a database in which to find linked records (<code>db</code>).
If we set this last argument to &#39;all&#39; we can find links in multiple databases:</p>

<pre><code class="r">all_the_links &lt;- entrez_link(dbfrom=&#39;gene&#39;, id=351, db=&#39;all&#39;)
all_the_links
</code></pre>

<pre><code>## elink object with contents:
##  $links: IDs for linked records from NCBI
## 
</code></pre>

<p>Just as with <code>entrez_search</code> the returned object behaves like a list, and we can
learn a little about its contents by printing it. In the case, all of the
information is in <code>links</code> (and there&#39;s a lot of them!):</p>

<pre><code class="r">all_the_links$links
</code></pre>

<pre><code>## elink result with information from 54 databases:
##  [1] gene_bioconcepts               gene_biosystems               
##  [3] gene_biosystems_all            gene_clinvar                  
##  [5] gene_clinvar_specific          gene_dbvar                    
##  [7] gene_genome                    gene_gtr                      
##  [9] gene_homologene                gene_medgen_diseases          
## [11] gene_pcassay_alltarget_list    gene_pcassay_alltarget_summary
## [13] gene_pcassay_rnai              gene_pcassay_target           
## [15] gene_probe                     gene_structure                
## [17] gene_bioproject                gene_books                    
## [19] gene_cdd                       gene_gene_h3k4me3             
## [21] gene_gene_neighbors            gene_genereviews              
## [23] gene_genome2                   gene_geoprofiles              
## [25] gene_nuccore                   gene_nuccore_mgc              
## [27] gene_nuccore_pos               gene_nuccore_refseqgene       
## [29] gene_nuccore_refseqrna         gene_nucest                   
## [31] gene_nucest_clust              gene_nucleotide               
## [33] gene_nucleotide_clust          gene_nucleotide_mgc           
## [35] gene_nucleotide_mgc_url        gene_nucleotide_pos           
## [37] gene_omim                      gene_pcassay_proteintarget    
## [39] gene_pccompound                gene_pcsubstance              
## [41] gene_pmc                       gene_pmc_nucleotide           
## [43] gene_protein                   gene_protein_refseq           
## [45] gene_pubmed                    gene_pubmed_citedinomim       
## [47] gene_pubmed_pmc_nucleotide     gene_pubmed_rif               
## [49] gene_snp                       gene_snp_geneview             
## [51] gene_sparcle                   gene_taxonomy                 
## [53] gene_unigene                   gene_varview
</code></pre>

<p>The names of the list elements are in the format <code>[source_database]_[linked_database]</code> 
and the elements themselves contain a vector of linked-IDs. So, if we want to
find open access publications associated with this gene we could get linked records
in PubMed Central:</p>

<pre><code class="r">all_the_links$links$gene_pmc[1:10]
</code></pre>

<pre><code>##  [1] &quot;5796664&quot; &quot;5761312&quot; &quot;5714184&quot; &quot;5650912&quot; &quot;5561919&quot; &quot;5560349&quot; &quot;5559291&quot;
##  [8] &quot;5548265&quot; &quot;5540602&quot; &quot;5434815&quot;
</code></pre>

<p>Or if were interested in this gene&#39;s role in diseases we could find links to clinVar:</p>

<pre><code class="r">all_the_links$links$gene_clinvar
</code></pre>

<pre><code>##   [1] &quot;453313&quot; &quot;450260&quot; &quot;446856&quot; &quot;446855&quot; &quot;446854&quot; &quot;443979&quot; &quot;442418&quot;
##   [8] &quot;397432&quot; &quot;396808&quot; &quot;396332&quot; &quot;396150&quot; &quot;394309&quot; &quot;391496&quot; &quot;369359&quot;
##  [15] &quot;339659&quot; &quot;339658&quot; &quot;339657&quot; &quot;339656&quot; &quot;339655&quot; &quot;339654&quot; &quot;339653&quot;
##  [22] &quot;339652&quot; &quot;339651&quot; &quot;339650&quot; &quot;339649&quot; &quot;339648&quot; &quot;339647&quot; &quot;339646&quot;
##  [29] &quot;339645&quot; &quot;339644&quot; &quot;339643&quot; &quot;339642&quot; &quot;339641&quot; &quot;339640&quot; &quot;339639&quot;
##  [36] &quot;339638&quot; &quot;339637&quot; &quot;339636&quot; &quot;339635&quot; &quot;339634&quot; &quot;339633&quot; &quot;339632&quot;
##  [43] &quot;339631&quot; &quot;339630&quot; &quot;339629&quot; &quot;339628&quot; &quot;339627&quot; &quot;339626&quot; &quot;339625&quot;
##  [50] &quot;339624&quot; &quot;339623&quot; &quot;339622&quot; &quot;339621&quot; &quot;339620&quot; &quot;339619&quot; &quot;253512&quot;
##  [57] &quot;253403&quot; &quot;236549&quot; &quot;236548&quot; &quot;236547&quot; &quot;221889&quot; &quot;160886&quot; &quot;155682&quot;
##  [64] &quot;155309&quot; &quot;155093&quot; &quot;155053&quot; &quot;154360&quot; &quot;154063&quot; &quot;153438&quot; &quot;152839&quot;
##  [71] &quot;151388&quot; &quot;150018&quot; &quot;149551&quot; &quot;149418&quot; &quot;149160&quot; &quot;149035&quot; &quot;148411&quot;
##  [78] &quot;148262&quot; &quot;148180&quot; &quot;146125&quot; &quot;145984&quot; &quot;145474&quot; &quot;145468&quot; &quot;145332&quot;
##  [85] &quot;145107&quot; &quot;144677&quot; &quot;144194&quot; &quot;127268&quot; &quot;98242&quot;  &quot;98241&quot;  &quot;98240&quot; 
##  [92] &quot;98239&quot;  &quot;98238&quot;  &quot;98237&quot;  &quot;98236&quot;  &quot;98235&quot;  &quot;59247&quot;  &quot;59246&quot; 
##  [99] &quot;59245&quot;  &quot;59243&quot;  &quot;59226&quot;  &quot;59224&quot;  &quot;59223&quot;  &quot;59222&quot;  &quot;59221&quot; 
## [106] &quot;59010&quot;  &quot;59005&quot;  &quot;59004&quot;  &quot;37145&quot;  &quot;32099&quot;  &quot;18106&quot;  &quot;18105&quot; 
## [113] &quot;18104&quot;  &quot;18103&quot;  &quot;18102&quot;  &quot;18101&quot;  &quot;18100&quot;  &quot;18099&quot;  &quot;18098&quot; 
## [120] &quot;18097&quot;  &quot;18096&quot;  &quot;18095&quot;  &quot;18094&quot;  &quot;18093&quot;  &quot;18092&quot;  &quot;18091&quot; 
## [127] &quot;18090&quot;  &quot;18089&quot;  &quot;18088&quot;  &quot;18087&quot;
</code></pre>

<p>###Narrowing our focus</p>

<p>If we know beforehand what sort of links we&#39;d like to find , we can
to use the <code>db</code> argument to narrow the focus of a call to <code>entrez_link</code>.</p>

<p>For instance, say we are interested in knowing about all of the 
RNA transcripts associated with the Amyloid Beta Precursor gene in humans. 
Transcript sequences are stored in the nucleotide database (referred
to as <code>nuccore</code> in EUtils), so to find transcripts associated with a given gene
we need to set <code>dbfrom=gene</code> and <code>db=nuccore</code>.</p>

<pre><code class="r">nuc_links &lt;- entrez_link(dbfrom=&#39;gene&#39;, id=351, db=&#39;nuccore&#39;)
nuc_links
</code></pre>

<pre><code>## elink object with contents:
##  $links: IDs for linked records from NCBI
## 
</code></pre>

<pre><code class="r">nuc_links$links
</code></pre>

<pre><code>## elink result with information from 5 databases:
## [1] gene_nuccore            gene_nuccore_mgc        gene_nuccore_pos       
## [4] gene_nuccore_refseqgene gene_nuccore_refseqrna
</code></pre>

<p>The object we get back contains links to the nucleotide database generally, but
also to special subsets of that database like <a href="http://www.ncbi.nlm.nih.gov/refseq/">refseq</a>. 
We can take advantage of this narrower set of links to find IDs that match unique
transcripts from our gene of interest.</p>

<pre><code class="r">nuc_links$links$gene_nuccore_refseqrna
</code></pre>

<pre><code>##  [1] &quot;324021747&quot; &quot;324021746&quot; &quot;324021739&quot; &quot;324021737&quot; &quot;324021735&quot;
##  [6] &quot;228008405&quot; &quot;228008404&quot; &quot;228008403&quot; &quot;228008402&quot; &quot;228008401&quot;
</code></pre>

<p>We can use these ids in calls to <code>entrez_fetch()</code> or <code>entrez_summary()</code> to learn
more about the transcripts they represent. </p>

<p>###External links</p>

<p>In addition to finding data within the NCBI, <code>entrez_link</code> can turn up
connections to external databases. Perhaps the most interesting example is
finding links to the full text of papers in PubMed. For example, when I wrote
this document the first paper linked to Amyloid Beta Precursor  had a unique ID of
<code>25500142</code>. We can find links to the full text of that paper with <code>entrez_link</code> 
by setting the <code>cmd</code> argument to &#39;llinks&#39;:</p>

<pre><code class="r">paper_links &lt;- entrez_link(dbfrom=&quot;pubmed&quot;, id=25500142, cmd=&quot;llinks&quot;)
paper_links
</code></pre>

<pre><code>## elink object with contents:
##  $linkouts: links to external websites
</code></pre>

<p>Each element of the <code>linkouts</code> object contains information about an external
source of data on this paper:</p>

<pre><code class="r">paper_links$linkouts
</code></pre>

<pre><code>## $ID_25500142
## $ID_25500142[[1]]
## Linkout from Elsevier Science 
##  $Url: http://linkinghub.elsevier ...
## 
## $ID_25500142[[2]]
## Linkout from Europe PubMed Central 
##  $Url: http://europepmc.org/abstr ...
## 
## $ID_25500142[[3]]
## Linkout from Ovid Technologies, Inc. 
##  $Url: http://ovidsp.ovid.com/ovi ...
## 
## $ID_25500142[[4]]
## Linkout from PubMed Central 
##  $Url: https://www.ncbi.nlm.nih.g ...
## 
## $ID_25500142[[5]]
## Linkout from MedlinePlus Health Information 
##  $Url: https://medlineplus.gov/al ...
## 
## $ID_25500142[[6]]
## Linkout from Mouse Genome Informatics (MGI) 
##  $Url: http://www.informatics.jax ...
</code></pre>

<p>Each of those linkout objects contains quite a lot of information, but the URL 
is probably the most useful. For that reason, <code>rentrez</code> provides the
function <code>linkout_urls</code> to make extracting just the URL simple:</p>

<pre><code class="r">linkout_urls(paper_links)
</code></pre>

<pre><code>## $ID_25500142
## [1] &quot;http://linkinghub.elsevier.com/retrieve/pii/S0014-4886(14)00393-8&quot;      
## [2] &quot;http://europepmc.org/abstract/MED/25500142&quot;                             
## [3] &quot;http://ovidsp.ovid.com/ovidweb.cgi?T=JS&amp;PAGE=linkout&amp;SEARCH=25500142.ui&quot;
## [4] &quot;https://www.ncbi.nlm.nih.gov/pmc/articles/pmid/25500142/&quot;               
## [5] &quot;https://medlineplus.gov/alzheimersdisease.html&quot;                         
## [6] &quot;http://www.informatics.jax.org/reference/25500142&quot;
</code></pre>

<p>The full list of options for the <code>cmd</code> argument are given in in-line
documentation (<code>?entrez_link</code>). If you are interested in finding full text
records for a large number of articles checkout the package 
<a href="https://github.com/ropensci/fulltext">fulltext</a> which makes use of multiple
sources (including the NCBI) to discover the full text articles.</p>

<p>###Using more than one ID</p>

<p>It is possible to pass more than one ID to <code>entrez_link()</code>. By default, doing so
will give you a single elink object containing the complete set of links for 
<em>all</em> of the IDs that you specified. So, if you were looking for protein IDs
related to specific genes you could do:</p>

<pre><code class="r">all_links_together  &lt;- entrez_link(db=&quot;protein&quot;, dbfrom=&quot;gene&quot;, id=c(&quot;93100&quot;, &quot;223646&quot;))
all_links_together
</code></pre>

<pre><code>## elink object with contents:
##  $links: IDs for linked records from NCBI
## 
</code></pre>

<pre><code class="r">all_links_together$links$gene_protein
</code></pre>

<pre><code>##  [1] &quot;1034662002&quot; &quot;1034662000&quot; &quot;1034661998&quot; &quot;1034661996&quot; &quot;1034661994&quot;
##  [6] &quot;1034661992&quot; &quot;558472750&quot;  &quot;545685826&quot;  &quot;194394158&quot;  &quot;166221824&quot; 
## [11] &quot;154936864&quot;  &quot;148697547&quot;  &quot;148697546&quot;  &quot;122346659&quot;  &quot;119602646&quot; 
## [16] &quot;119602645&quot;  &quot;119602644&quot;  &quot;119602643&quot;  &quot;119602642&quot;  &quot;81899807&quot;  
## [21] &quot;74215266&quot;   &quot;74186774&quot;   &quot;37787317&quot;   &quot;37787309&quot;   &quot;37787307&quot;  
## [26] &quot;37787305&quot;   &quot;37589273&quot;   &quot;33991172&quot;   &quot;31982089&quot;   &quot;26339824&quot;  
## [31] &quot;26329351&quot;   &quot;21619615&quot;   &quot;10834676&quot;
</code></pre>

<p>Although this behaviour might sometimes be useful, it means we&#39;ve lost track of
which <code>protein</code> ID is linked to which <code>gene</code> ID. To retain that information we
can set <code>by_id</code> to <code>TRUE</code>. This gives us a list of elink objects, each once
containing links from a single <code>gene</code> ID:</p>

<pre><code class="r">all_links_sep  &lt;- entrez_link(db=&quot;protein&quot;, dbfrom=&quot;gene&quot;, id=c(&quot;93100&quot;, &quot;223646&quot;), by_id=TRUE)
all_links_sep
</code></pre>

<pre><code>## List of 2 elink objects,each containing
##   $links: IDs for linked records from NCBI
## 
</code></pre>

<pre><code class="r">lapply(all_links_sep, function(x) x$links$gene_protein)
</code></pre>

<pre><code>## [[1]]
##  [1] &quot;1034662002&quot; &quot;1034662000&quot; &quot;1034661998&quot; &quot;1034661996&quot; &quot;1034661994&quot;
##  [6] &quot;1034661992&quot; &quot;558472750&quot;  &quot;545685826&quot;  &quot;194394158&quot;  &quot;166221824&quot; 
## [11] &quot;154936864&quot;  &quot;122346659&quot;  &quot;119602646&quot;  &quot;119602645&quot;  &quot;119602644&quot; 
## [16] &quot;119602643&quot;  &quot;119602642&quot;  &quot;37787309&quot;   &quot;37787307&quot;   &quot;37787305&quot;  
## [21] &quot;33991172&quot;   &quot;21619615&quot;   &quot;10834676&quot;  
## 
## [[2]]
##  [1] &quot;148697547&quot; &quot;148697546&quot; &quot;81899807&quot;  &quot;74215266&quot;  &quot;74186774&quot; 
##  [6] &quot;37787317&quot;  &quot;37589273&quot;  &quot;31982089&quot;  &quot;26339824&quot;  &quot;26329351&quot;
</code></pre>

<h2>Getting summary data: <code>entrez_summary()</code></h2>

<p>Having found the unique IDs for some records via <code>entrez_search</code> or <code>entrez_link()</code>, you are
probably going to want to learn something about them. The <code>Eutils</code> API has two
ways to get information about a record. <code>entrez_fetch()</code> returns &#39;full&#39; records
in varying formats and <code>entrez_summary()</code> returns less information about each
record, but in relatively simple format. Very often the summary records have the information
you are after, so <code>rentrez</code> provides functions to parse and summarise summary
records.</p>

<p>###The summary record</p>

<p><code>entrez_summary()</code> takes a vector of unique IDs for the samples you want to get
summary information from. Let&#39;s start by finding out something about the paper
describing <a href="https://github.com/ropensci/taxize">Taxize</a>, using its PubMed ID:</p>

<pre><code class="r">taxize_summ &lt;- entrez_summary(db=&quot;pubmed&quot;, id=24555091)
taxize_summ
</code></pre>

<pre><code>## esummary result with 42 items:
##  [1] uid               pubdate           epubdate         
##  [4] source            authors           lastauthor       
##  [7] title             sorttitle         volume           
## [10] issue             pages             lang             
## [13] nlmuniqueid       issn              essn             
## [16] pubtype           recordstatus      pubstatus        
## [19] articleids        history           references       
## [22] attributes        pmcrefcount       fulljournalname  
## [25] elocationid       doctype           srccontriblist   
## [28] booktitle         medium            edition          
## [31] publisherlocation publishername     srcdate          
## [34] reportnumber      availablefromurl  locationlabel    
## [37] doccontriblist    docdate           bookname         
## [40] chapter           sortpubdate       sortfirstauthor
</code></pre>

<p>Once again, the object returned by <code>entrez_summary</code> behaves like a list, so you can extract
elements using <code>$</code>. For instance, we could convert our PubMed ID to another
article identifier&hellip;</p>

<pre><code class="r">taxize_summ$articleids
</code></pre>

<pre><code>##       idtype idtypen                           value
## 1     pubmed       1                        24555091
## 2        doi       3 10.12688/f1000research.2-191.v2
## 3        pmc       8                      PMC3901538
## 4        rid       8                        24563765
## 5        eid       8                        24555091
## 6    version       8                               2
## 7 version-id       8                               2
## 8      pmcid       5             pmc-id: PMC3901538;
</code></pre>

<p>&hellip;or see how many times the article has been cited in PubMed Central papers</p>

<pre><code class="r">taxize_summ$pmcrefcount
</code></pre>

<pre><code>## [1] 15
</code></pre>

<p>###Dealing with many records</p>

<p>If you give <code>entrez_summary()</code> a vector with more than one ID you&#39;ll get a
list of summary records back. Let&#39;s get those <em>Plasmodium vivax</em> papers we found
in the <code>entrez_search()</code> section back, and fetch some summary data on each paper:</p>

<pre><code class="r">vivax_search &lt;- entrez_search(db = &quot;pubmed&quot;,
                              term = &quot;(vivax malaria[MeSH]) AND (folic acid antagonists[MeSH])&quot;)
multi_summs &lt;- entrez_summary(db=&quot;pubmed&quot;, id=vivax_search$ids)
</code></pre>

<p><code>rentrez</code> provides a helper function, <code>extract_from_esummary()</code> that takes one
or more elements from every summary record in one of these lists. Here it is
working with one&hellip;</p>

<pre><code class="r">extract_from_esummary(multi_summs, &quot;fulljournalname&quot;)
</code></pre>

<pre><code>##                                                                                                                 29016333 
##                                                                  &quot;The American journal of tropical medicine and hygiene&quot; 
##                                                                                                                 28298235 
##                                                                                                        &quot;Malaria journal&quot; 
##                                                                                                                 24861816 
## &quot;Infection, genetics and evolution : journal of molecular epidemiology and evolutionary genetics in infectious diseases&quot; 
##                                                                                                                 24145518 
##                                                                                  &quot;Antimicrobial agents and chemotherapy&quot; 
##                                                                                                                 24007534 
##                                                                                                        &quot;Malaria journal&quot; 
##                                                                                                                 23230341 
##                                                                                     &quot;The Korean journal of parasitology&quot; 
##                                                                                                                 23043980 
##                                                                                              &quot;Experimental parasitology&quot; 
##                                                                                                                 20810806 
##                                                                  &quot;The American journal of tropical medicine and hygiene&quot; 
##                                                                                                                 20412783 
##                                                                                                           &quot;Acta tropica&quot; 
##                                                                                                                 19597012 
##                                                                                          &quot;Clinical microbiology reviews&quot; 
##                                                                                                                 17556611 
##                                                                  &quot;The American journal of tropical medicine and hygiene&quot; 
##                                                                                                                 17519409 
##                                                                                                                   &quot;JAMA&quot; 
##                                                                                                                 17368986 
##                                                                                                 &quot;Trends in parasitology&quot; 
##                                                                                                                 12374849 
##                                        &quot;Proceedings of the National Academy of Sciences of the United States of America&quot;
</code></pre>

<p>&hellip; and several elements:</p>

<pre><code class="r">date_and_cite &lt;- extract_from_esummary(multi_summs, c(&quot;pubdate&quot;, &quot;pmcrefcount&quot;,  &quot;title&quot;))
knitr::kable(head(t(date_and_cite)), row.names=FALSE)
</code></pre>

<table><thead>
<tr>
<th align="left">pubdate</th>
<th align="left">pmcrefcount</th>
<th align="left">title</th>
</tr>
</thead><tbody>
<tr>
<td align="left">2017 Dec</td>
<td align="left"></td>
<td align="left">Distribution of Mutations Associated with Antifolate and Chloroquine Resistance among Imported &lt;i&gt;Plasmodium vivax&lt;/i&gt; in the State of Qatar.</td>
</tr>
<tr>
<td align="left">2017 Mar 16</td>
<td align="left">2</td>
<td align="left">Clinical and molecular surveillance of drug resistant vivax malaria in Myanmar (2009-2016).</td>
</tr>
<tr>
<td align="left">2014 Aug</td>
<td align="left"></td>
<td align="left">Prevalence of mutations in the antifolates resistance-associated genes (dhfr and dhps) in Plasmodium vivax parasites from Eastern and Central Sudan.</td>
</tr>
<tr>
<td align="left">2014</td>
<td align="left">5</td>
<td align="left">Prevalence of polymorphisms in antifolate drug resistance molecular marker genes pvdhfr and pvdhps in clinical isolates of Plasmodium vivax from Kolkata, India.</td>
</tr>
<tr>
<td align="left">2013 Sep 5</td>
<td align="left">3</td>
<td align="left">Prevalence and patterns of antifolate and chloroquine drug resistance markers in Plasmodium vivax across Pakistan.</td>
</tr>
<tr>
<td align="left">2012 Dec</td>
<td align="left">14</td>
<td align="left">Prevalence of drug resistance-associated gene mutations in Plasmodium vivax in Central China.</td>
</tr>
</tbody></table>

<p>##Fetching full records: <code>entrez_fetch()</code></p>

<p>As useful as the summary records are, sometimes they just don&#39;t have the
information that you need. If you want a complete representation of a record you
can use <code>entrez_fetch</code>, using the argument <code>rettype</code> to specify the format you&#39;d
like the record in.</p>

<p>###Fetch DNA sequences in fasta format</p>

<p>Let&#39;s extend the example given in the <code>entrez_link()</code> section about finding
transcript for a given gene. This time we will fetch cDNA sequences of those
transcripts.We can start by repeating the steps in the earlier example
to get nucleotide IDs for refseq transcripts of two genes:</p>

<pre><code class="r">gene_ids &lt;- c(351, 11647)
linked_seq_ids &lt;- entrez_link(dbfrom=&quot;gene&quot;, id=gene_ids, db=&quot;nuccore&quot;)
linked_transripts &lt;- linked_seq_ids$links$gene_nuccore_refseqrna
head(linked_transripts)
</code></pre>

<pre><code>## [1] &quot;1039766414&quot; &quot;1039766413&quot; &quot;1039766411&quot; &quot;1039766410&quot; &quot;1039766409&quot;
## [6] &quot;563317856&quot;
</code></pre>

<p>Now we can get our sequences with <code>entrez_fetch</code>, setting <code>rettype</code> to &ldquo;fasta&rdquo;
(the list of formats available for <a href="http://www.ncbi.nlm.nih.gov/books/NBK25499/table/chapter4.T._valid_values_of__retmode_and/">each database is give in this table</a>):</p>

<pre><code class="r">all_recs &lt;- entrez_fetch(db=&quot;nuccore&quot;, id=linked_transripts, rettype=&quot;fasta&quot;)
class(all_recs)
</code></pre>

<pre><code>## [1] &quot;character&quot;
</code></pre>

<pre><code class="r">nchar(all_recs)
</code></pre>

<pre><code>## [1] 55183
</code></pre>

<p>Congratulations, now you have a really huge character vector! Rather than
printing all those thousands of bases we can take a peak at the top of the file:</p>

<pre><code class="r">cat(strwrap(substr(all_recs, 1, 500)), sep=&quot;\n&quot;)
</code></pre>

<pre><code>## &gt;XM_006538500.2 PREDICTED: Mus musculus alkaline phosphatase,
## liver/bone/kidney (Alpl), transcript variant X5, mRNA
## GCGCCCGTGGCTTGCGCGACTCCCACGCGCGCGCTCCGCCGGTCCCGCAGTGACTGTCCCAGCCACGGTG
## GGGACACGTGGAAGGTCAGGCTCCCTGGGGACCCACGACCTCCCGCTCCGGACTCCGCGCGCATCTCTTG
## TGGCCTGGCAGGATGATGGACGTGGCGCCCGCTGAGCCGCTACCCAGGACCTCACCCTCGTGCTAAGCAC
## CTGCTCCCGGTGCCCACGCGCCTCCGTAGTCCACAGCTGCGCCCTTCGTGGTCCCTTGGCACTCTGTCCC
## GTTGGTGTCTAAAGTAGTTGGGGAGCAGCAGGAAGAAGGCACGTGCTGCGATCTTTGGCGGGAGAGATCG
## GAGACCGCGTGCTAGTGTCTGTCTGAGAG
</code></pre>

<p>If we wanted to use these sequences in some other application we could write them 
to file:</p>

<pre><code class="r">write(all_recs, file=&quot;my_transcripts.fasta&quot;)
</code></pre>

<p>Alternatively, if you want to use them  within an R session<br/>
we could write them to a  temporary file then read that. In this case I&#39;m using <code>read.dna()</code> from the
pylogenetics package ape (but not executing the code block in this vignette, so
you don&#39;t have to install that package):</p>

<pre><code class="r">temp &lt;- tempfile()
write(all_recs, temp)
parsed_recs &lt;- ape::read.dna(all_recs, temp)
</code></pre>

<p>###Fetch a parsed XML document</p>

<p>Most of the NCBI&#39;s databases can return records in XML format. In additional to
downloading the text-representation of these files, <code>entrez_fetch()</code> can return
objects parsed by the <code>XML</code> package. As an example, we can check out the  Taxonomy
database&#39;s record for (did I mention they are amazing&hellip;.) <em>Tetrahymena
thermophila</em>, specifying we want the result to be parsed by setting
<code>parsed=TRUE</code>:</p>

<pre><code class="r">Tt &lt;- entrez_search(db=&quot;taxonomy&quot;, term=&quot;(Tetrahymena thermophila[ORGN]) AND Species[RANK]&quot;)
tax_rec &lt;- entrez_fetch(db=&quot;taxonomy&quot;, id=Tt$ids, rettype=&quot;xml&quot;, parsed=TRUE)
class(tax_rec)
</code></pre>

<pre><code>## [1] &quot;XMLInternalDocument&quot; &quot;XMLAbstractDocument&quot;
</code></pre>

<p>The package XML (which you have if you have installed <code>rentrez</code>) provides
functions to get information from these files. For relatively simple records
like this one you can use <code>XML::xmlToList</code>:</p>

<pre><code class="r">tax_list &lt;- XML::xmlToList(tax_rec)
tax_list$Taxon$GeneticCode
</code></pre>

<pre><code>## $GCId
## [1] &quot;6&quot;
## 
## $GCName
## [1] &quot;Ciliate Nuclear; Dasycladacean Nuclear; Hexamita Nuclear&quot;
</code></pre>

<p>For more complex records, which generate deeply-nested lists, you can use
<a href="https://en.wikipedia.org/wiki/XPath">XPath expressions</a> along with the function 
<code>XML::xpathSApply</code> or the extraction operatord <code>[</code> and <code>[[</code> to extract specific 
parts of the file. For instance, we can get the scientific name of each taxon 
in <em>T. thermophila</em>&#39;s lineage by specifying a path through the XML</p>

<pre><code class="r">tt_lineage &lt;- tax_rec[&quot;//LineageEx/Taxon/ScientificName&quot;]
tt_lineage[1:4]
</code></pre>

<pre><code>## [[1]]
## &lt;ScientificName&gt;cellular organisms&lt;/ScientificName&gt; 
## 
## [[2]]
## &lt;ScientificName&gt;Eukaryota&lt;/ScientificName&gt; 
## 
## [[3]]
## &lt;ScientificName&gt;Alveolata&lt;/ScientificName&gt; 
## 
## [[4]]
## &lt;ScientificName&gt;Ciliophora&lt;/ScientificName&gt;
</code></pre>

<p>As the name suggests, <code>XML::xpathSApply()</code> is a counterpart of base R&#39;s
<code>sapply</code>, and can be used to apply a function to
nodes in an XML object. A particularly useful function to apply is <code>XML::xmlValue</code>, 
which returns the content of the node:</p>

<pre><code class="r">XML::xpathSApply(tax_rec, &quot;//LineageEx/Taxon/ScientificName&quot;, XML::xmlValue)
</code></pre>

<pre><code>##  [1] &quot;cellular organisms&quot; &quot;Eukaryota&quot;          &quot;Alveolata&quot;         
##  [4] &quot;Ciliophora&quot;         &quot;Intramacronucleata&quot; &quot;Oligohymenophorea&quot; 
##  [7] &quot;Hymenostomatida&quot;    &quot;Tetrahymenina&quot;      &quot;Tetrahymenidae&quot;    
## [10] &quot;Tetrahymena&quot;
</code></pre>

<p>There are a few more complex examples of using <code>XPath</code> <a href="https://github.com/ropensci/rentrez/wiki">on the rentrez wiki</a></p>

<p><a name="web_history"></a></p>

<p>##Using NCBI&#39;s Web History features</p>

<p>When you are dealing with very large queries it can be time  consuming to pass
long vectors of unique IDs to and from the NCBI. To avoid this problem, the NCBI
provides a feature called &ldquo;web history&rdquo; which allows users to store IDs on the
NCBI servers then refer to them in future calls.</p>

<p>###Post a set of IDs to the NCBI for later use: <code>entrez_post()</code></p>

<p>If you have a list of many NCBI IDs that you want to use later on, you can post
them to the NCBI&#39;s severs. In order to provide a brief example, I&#39;m going to post just one
ID, the <code>omim</code> identifier for asthma:</p>

<pre><code class="r">upload &lt;- entrez_post(db=&quot;omim&quot;, id=600807)
upload
</code></pre>

<pre><code>## Web history object (QueryKey = 1, WebEnv = NCID_1_68403...)
</code></pre>

<p>The NCBI sends you back some information you can use to refer to the posted IDs. 
In <code>rentrez</code>, that information is represented as a <code>web_history</code> object. </p>

<p>Note that if you have a very long list of IDs you may receive a 414 error when
you try to upload them. If you have such a list (and they come from an external
sources rather than a search that can be save to a <code>web_history</code> object), you
may have to &#39;chunk&#39; the IDs into smaller sets that can processed. </p>

<p>###Get a <code>web_history</code> object from <code>entrez_search</code> or <code>entrez_link()</code></p>

<p>In addition to directly uploading IDs to the NCBI, you can use the web history
features with <code>entrez_search</code> and <code>entrez_link</code>. For instance, imagine you wanted to
find all of the sequences of the widely-studied gene COI from all snails
(which are members of the taxonomic group Gastropoda):</p>

<pre><code class="r">entrez_search(db=&quot;nuccore&quot;, term=&quot;COI[Gene] AND Gastropoda[ORGN]&quot;)
</code></pre>

<pre><code>## Entrez search result with 72586 hits (object contains 20 IDs and no web_history object)
##  Search term (as translated):  COI[Gene] AND &quot;Gastropoda&quot;[Organism]
</code></pre>

<p>That&#39;s a lot of sequences! If you really wanted to download all of these it
would be a good idea to save all those IDs to the server by setting
<code>use_history</code> to <code>TRUE</code> (note you now get a <code>web_history</code> object along with your
normal search result):</p>

<pre><code class="r">snail_coi &lt;- entrez_search(db=&quot;nuccore&quot;, term=&quot;COI[Gene] AND Gastropoda[ORGN]&quot;, use_history=TRUE)
snail_coi
</code></pre>

<pre><code>## Entrez search result with 72586 hits (object contains 20 IDs and a web_history object)
##  Search term (as translated):  COI[Gene] AND &quot;Gastropoda&quot;[Organism]
</code></pre>

<pre><code class="r">snail_coi$web_history
</code></pre>

<pre><code>## Web history object (QueryKey = 1, WebEnv = NCID_1_15784...)
</code></pre>

<p>Similarity, <code>entrez_link()</code> can return <code>web_history</code> objects by using the <code>cmd</code>
<code>neighbor_history</code>. Let&#39;s find genetic variants (from the clinvar database)
associated with asthma (using the same OMIM ID we identified earlier):</p>

<pre><code class="r">asthma_clinvar &lt;- entrez_link(dbfrom=&quot;omim&quot;, db=&quot;clinvar&quot;, cmd=&quot;neighbor_history&quot;, id=600807)
asthma_clinvar$web_histories
</code></pre>

<pre><code>## $omim_clinvar
## Web history object (QueryKey = 1, WebEnv = NCID_1_15784...)
</code></pre>

<p>As you can see, instead of returning lists of IDs for each linked database (as
it would be default), <code>entrez_link()</code> now  returns a list of web_histories.</p>

<p>###Use a <code>web_history</code> object</p>

<p>Once you have those IDs stored on the NCBI&#39;s servers, you are going to want to
do something with them. The functions <code>entrez_fetch()</code> <code>entrez_summary()</code> and
<code>entrez_link()</code> can all use <code>web_history</code> objects in exactly the same way they
use IDs. </p>

<p>So, we could repeat the last example (finding variants linked to asthma), but this
time using the ID we uploaded earlier</p>

<pre><code class="r">asthma_variants &lt;- entrez_link(dbfrom=&quot;omim&quot;, db=&quot;clinvar&quot;, cmd=&quot;neighbor_history&quot;, web_history=upload)
asthma_variants
</code></pre>

<pre><code>## elink object with contents:
##  $web_histories: Objects containing web history information
</code></pre>

<p>&hellip; if we want to get some genetic information about these variants we need to
map our clinvar IDs to SNP IDs:</p>

<pre><code class="r">snp_links &lt;- entrez_link(dbfrom=&quot;clinvar&quot;, db=&quot;snp&quot;, 
                         web_history=asthma_variants$web_histories$omim_clinvar,
                         cmd=&quot;neighbor_history&quot;)
snp_summ &lt;- entrez_summary(db=&quot;snp&quot;, web_history=snp_links$web_histories$clinvar_snp)
knitr::kable(extract_from_esummary(snp_summ, c(&quot;chr&quot;, &quot;fxn_class&quot;, &quot;global_maf&quot;)))
</code></pre>

<table><thead>
<tr>
<th align="left"></th>
<th align="left">41364547</th>
<th align="left">11558538</th>
<th align="left">20541</th>
</tr>
</thead><tbody>
<tr>
<td align="left">chr</td>
<td align="left">11</td>
<td align="left">2</td>
<td align="left">5</td>
</tr>
<tr>
<td align="left">fxn_class</td>
<td align="left">intron-variant,utr-variant-5-prime</td>
<td align="left">intron-variant,missense,nc-transcript-variant,reference,utr-variant-5-prime</td>
<td align="left">missense,reference</td>
</tr>
<tr>
<td align="left">global_maf</td>
<td align="left">A=0.0036/18</td>
<td align="left">T=0.0595/298</td>
<td align="left">A=0.2700/1352</td>
</tr>
</tbody></table>

<p>If you really wanted to you could also use <code>web_history</code> objects to download all those thousands of COI sequences.
When downloading large sets of data, it is a good idea to take advantage of the
arguments <code>retmax</code> and <code>restart</code> to split the request up into smaller chunks.
For instance, we could get the first 200 sequences in 50-sequence chunks:</p>

<p>(note: this code block is not executed as part of the vignette to save time and bandwidth):</p>

<pre><code class="r">for( seq_start in seq(1,200,50)){
    recs &lt;- entrez_fetch(db=&quot;nuccore&quot;, web_history=snail_coi$web_history,
                         rettype=&quot;fasta&quot;, retmax=50, retstart=seq_start)
    cat(recs, file=&quot;snail_coi.fasta&quot;, append=TRUE)
    cat(seq_start+49, &quot;sequences downloaded\r&quot;)
}
</code></pre>

<h2>Using API Keys</h2>

<p>By default, the NCBI limits users to making only 3 requests per second (and
<code>rentrez</code> enforces that limit). Users who register for an &ldquo;API key&rdquo; are able to
make up to ten requests per second. Getting one of these keys is simple, you
just need to <a href="https://www.ncbi.nlm.nih.gov/account/">register for &ldquo;my ncbi&rdquo;
account</a> then click on a button in the
<a href="https://www.ncbi.nlm.nih.gov/account/settings/">account settings page</a>.</p>

<p>Once you have an API key, rentrez will allow you to take advantage of it. For 
one-off cases, this is as simple as adding the <code>api_key</code> argument to given
function call. (Note these examples are not executed as part of this document, 
as the  API key used here not a real one).</p>

<pre><code class="r">entrez_link(db=&quot;protein&quot;, dbfrom=&quot;gene&quot;, id=93100, api_key =&quot;ABCD123&quot;)
</code></pre>

<p>It most cases you will want to use your API for each of several calls to the
NCBI. <code>rentrez</code> makes this easy by allowing you to set an environment variable
,<code>ENTREZ_KEY</code>. Once this value is set to your key <code>rentrez</code> will use it for all
requests to the NCBI. To set the value for a single R session you can use the
function <code>set_entrez_key()</code>. Here we set the value and confirm it is available.</p>

<pre><code class="r">set_entrez_key(&quot;ABCD123&quot;)
Sys.getenv(&quot;ENTREZ_KEY&quot;)
</code></pre>

<pre><code>## [1] &quot;ABCD123&quot;
</code></pre>

<p>If you use <code>rentrez</code> often you should edit your <code>.Renviron</code> file (see <code>r
help(Startup)</code> for description of this file)  to include your key. Doing so will
mean all requests you send will take advantage of your API key.</p>

<pre><code class="ini">ENTREZ_KEY=ABCD123
</code></pre>

<p>As long as an API key is set by one of these methods, <code>rentrez</code> will allow you
to make up to ten requests per second.</p>

<h2>What next ?</h2>

<p>This tutorial has introduced you to the core functions of <code>rentrez</code>, there are
almost limitless ways that you could put them together. <a href="https://github.com/ropensci/rentrez/wiki">Check out the wiki</a>
for more specific examples, and be sure to read the inline-documentation for
each function. If you run into problem with rentrez, or just need help with the
package and <code>Eutils</code> please contact us by opening an issue at the <a href="https://github.com/ropensci/rentrez/issues">github
repository</a></p>

</body>

</html>
